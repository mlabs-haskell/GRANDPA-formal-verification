<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Grandpa.Protocol.State</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Grandpa.Protocol.State</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Blocks.AnyBlock.html#"><span class="id" title="library">Blocks.AnyBlock</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.DataTypes.Dictionary.html#"><span class="id" title="library">DataTypes.Dictionary</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Message.html#"><span class="id" title="library">Message</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Votes.html#"><span class="id" title="library">Votes</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.VoterState.html#"><span class="id" title="library">VoterState</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Time.html#"><span class="id" title="library">Time</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.RoundNumber.html#"><span class="id" title="library">RoundNumber</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#"><span class="id" title="library">Protocol.FinalizedBlock</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Classes.Functor.html#"><span class="id" title="library">Classes.Functor</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Classes.Math.All.html#"><span class="id" title="library">Classes.Math.All</span></a>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="State" class="idref" href="#State"><span class="id" title="record">State</span></a> :={<br/>
&nbsp;&nbsp;</div>

<div class="doc">
    Maintains a global counter of all messages emitted until now.
    In a real implementation every voter should attach a ID 
    to their messages and that together with the voter ID 
    can be used as an id. We don't need to do that in our model.
  
</div>
<div class="code">
&nbsp;&nbsp;<a id="message_count" class="idref" href="#message_count"><span class="id" title="projection">message_count</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;</div>

<div class="doc">
    Messages that haven't been received by some voter yet.
  
</div>
<div class="code">
&nbsp;&nbsp;;<a id="pending_messages" class="idref" href="#pending_messages"><span class="id" title="projection">pending_messages</span></a>:<a class="idref" href="Grandpa.DataTypes.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary</span></a> <a class="idref" href="Grandpa.Message.html#MessageId"><span class="id" title="definition">MessageId</span></a> <a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a> <br/>
&nbsp;&nbsp;;<a id="voters_state" class="idref" href="#voters_state"><span class="id" title="projection">voters_state</span></a>:<a class="idref" href="Grandpa.DataTypes.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a><br/>
&nbsp;&nbsp;</div>

<div class="doc">
     All the blocks who any voter have finalized.
  
</div>
<div class="code">
&nbsp;&nbsp;;<a id="global_finalized_blocks" class="idref" href="#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#FinalizedBlock"><span class="id" title="record">FinalizedBlock</span></a> <br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Update" class="idref" href="#Update"><span class="id" title="section">Update</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="empty_state" class="idref" href="#empty_state"><span class="id" title="definition">empty_state</span></a> : <a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>:=0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.DataTypes.Dictionary.html#empty"><span class="id" title="definition">Dictionary.empty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.DataTypes.Dictionary.html#empty"><span class="id" title="definition">Dictionary.empty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a><br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="update_message" class="idref" href="#update_message"><span class="id" title="definition">update_message</span></a> (<a id="state:6" class="idref" href="#state:6"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a>) (<a id="msg:7" class="idref" href="#msg:7"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>) : <a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:6"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.DataTypes.Dictionary.html#add"><span class="id" title="definition">Dictionary.add</span></a> <a class="idref" href="Grandpa.Protocol.State.html#msg:7"><span class="id" title="variable">msg</span></a>.(<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>) <a class="idref" href="Grandpa.Protocol.State.html#msg:7"><span class="id" title="variable">msg</span></a> <a class="idref" href="Grandpa.Protocol.State.html#state:6"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:6"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:6"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="advance_count" class="idref" href="#advance_count"><span class="id" title="definition">advance_count</span></a> (<a id="state:8" class="idref" href="#state:8"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Grandpa.Protocol.State.html#state:8"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:= <a class="idref" href="Grandpa.Protocol.State.html#state:8"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:8"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:8"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="update_voter_state" class="idref" href="#update_voter_state"><span class="id" title="definition">update_voter_state</span></a> (<a id="state:9" class="idref" href="#state:9"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a>) (<a id="voter:10" class="idref" href="#voter:10"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a>) (<a id="vs:11" class="idref" href="#vs:11"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>) : <a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:9"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:9"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.DataTypes.Dictionary.html#add"><span class="id" title="definition">Dictionary.add</span></a> <a class="idref" href="Grandpa.Protocol.State.html#voter:10"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.State.html#vs:11"><span class="id" title="variable">vs</span></a> <a class="idref" href="Grandpa.Protocol.State.html#state:9"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:9"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="remove_message" class="idref" href="#remove_message"><span class="id" title="definition">remove_message</span></a> (<a id="state:12" class="idref" href="#state:12"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a>) (<a id="msg:13" class="idref" href="#msg:13"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>): <a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:12"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.DataTypes.Dictionary.html#delete"><span class="id" title="definition">Dictionary.delete</span></a> <a class="idref" href="Grandpa.Protocol.State.html#msg:13"><span class="id" title="variable">msg</span></a>.(<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>) <a class="idref" href="Grandpa.Protocol.State.html#state:12"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:12"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:12"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="update_add_finalized_block" class="idref" href="#update_add_finalized_block"><span class="id" title="definition">update_add_finalized_block</span></a> (<a id="state:14" class="idref" href="#state:14"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a>) (<a id="fb:15" class="idref" href="#fb:15"><span class="id" title="binder">fb</span></a>:<a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#FinalizedBlock"><span class="id" title="record">FinalizedBlock</span></a>):<a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a> <br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:14"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:14"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Protocol.State.html#state:14"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#cons"><span class="id" title="abbreviation">List.cons</span></a> <a class="idref" href="Grandpa.Protocol.State.html#fb:15"><span class="id" title="variable">fb</span></a> <a class="idref" href="Grandpa.Protocol.State.html#state:14"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Grandpa.Protocol.State.html#Update"><span class="id" title="section">Update</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="ProcessIo" class="idref" href="#ProcessIo"><span class="id" title="section">ProcessIo</span></a>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">list</span>.<br/>

<br/>
</div>

<div class="doc">
*ProcessIo
Those functions works on the outputs of the Io class. 
They originally required the Io class, but we made them pure.

<div class="paragraph"> </div>


<div class="paragraph"> </div>

Auxiliary function, the output are :
<ul class="doclist">
<li> The number of byzantine voters

</li>
<li> The number of prevoters

</li>
<li> The number of precommiters

</li>
</ul>
After one step of the processing.

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="process_round_voters_step" class="idref" href="#process_round_voters_step"><span class="id" title="definition">process_round_voters_step</span></a> <br/>
&nbsp;&nbsp;(<a id="acc:16" class="idref" href="#acc:16"><span class="id" title="binder">acc</span></a>: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">)*(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">)</span></a> )<br/>
&nbsp;&nbsp;(<a id="value:17" class="idref" href="#value:17"><span class="id" title="binder">value</span></a>:<a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a>)<br/>
&nbsp;&nbsp;: (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a>)<br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.State.html#acc:16"><span class="id" title="variable">acc</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.State.html#value:17"><span class="id" title="variable">value</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">kind</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">kind</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">Bizantine</span></a> <a class="idref" href="Grandpa.VoterState.html#VotePrevote"><span class="id" title="constructor">VotePrevote</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">Bizantine</span></a> <a class="idref" href="Grandpa.VoterState.html#VotePrecommit"><span class="id" title="constructor">VotePrecommit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">Bizantine</span></a> <a class="idref" href="Grandpa.VoterState.html#VoteBoth"><span class="id" title="constructor">VoteBoth</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Honest"><span class="id" title="constructor">Honest</span></a> <a class="idref" href="Grandpa.VoterState.html#VotePrevote"><span class="id" title="constructor">VotePrevote</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Honest"><span class="id" title="constructor">Honest</span></a> <a class="idref" href="Grandpa.VoterState.html#VotePrecommit"><span class="id" title="constructor">VotePrecommit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Honest"><span class="id" title="constructor">Honest</span></a> <a class="idref" href="Grandpa.VoterState.html#VoteBoth"><span class="id" title="constructor">VoteBoth</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Takes a dictionary like the one returned by Io, that represents 
the voters involved in a round together with the information of 
what kind of voter are they going to be.

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="process_round_voters_from" class="idref" href="#process_round_voters_from"><span class="id" title="definition">process_round_voters_from</span></a> <br/>
&nbsp;&nbsp;&nbsp;(<a id="round_dictionary:21" class="idref" href="#round_dictionary:21"><span class="id" title="binder">round_dictionary</span></a>:<a class="idref" href="Grandpa.DataTypes.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a>)<br/>
&nbsp;&nbsp;: (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a>)<br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="as_list:22" class="idref" href="#as_list:22"><span class="id" title="binder">as_list</span></a> :=<a class="idref" href="Grandpa.DataTypes.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_dictionary:21"><span class="id" title="variable">round_dictionary</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <a class="idref" href="Grandpa.Protocol.State.html#process_round_voters_step"><span class="id" title="definition">process_round_voters_step</span></a> <a class="idref" href="Grandpa.Protocol.State.html#as_list:22"><span class="id" title="variable">as_list</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_round_total_voters_from" class="idref" href="#get_round_total_voters_from"><span class="id" title="definition">get_round_total_voters_from</span></a><br/>
&nbsp;&nbsp;(<a id="round_dictionary:23" class="idref" href="#round_dictionary:23"><span class="id" title="binder">round_dictionary</span></a>:<a class="idref" href="Grandpa.DataTypes.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> (<a class="idref" href="Grandpa.DataTypes.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_dictionary:23"><span class="id" title="variable">round_dictionary</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_round_bizantiners_number" class="idref" href="#get_round_bizantiners_number"><span class="id" title="definition">get_round_bizantiners_number</span></a> <br/>
&nbsp;&nbsp;(<a id="round_dictionary:24" class="idref" href="#round_dictionary:24"><span class="id" title="binder">round_dictionary</span></a>:<a class="idref" href="Grandpa.DataTypes.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.State.html#process_round_voters_from"><span class="id" title="definition">process_round_voters_from</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_dictionary:24"><span class="id" title="variable">round_dictionary</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒ <span class="id" title="var">bizantiners_number</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The canonical way to construct the initial state for the 
protocol based on the information provided by the Io class.

<div class="paragraph"> </div>

In particular we:
<ul class="doclist">
<li> Set the <span class="inlinecode"><a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a></span> to zero.

</li>
<li> Set the <span class="inlinecode"><a class="idref" href="Grandpa.VoterState.html#pending_messages"><span class="id" title="projection">pending_messages</span></a></span> as the empty dictionary.

</li>
<li> Initialize the voters state for every voter ever in the model.
    (This is guaranteed by a predicate stored in Io, using it on a 
     different collection posses no guarantees.)

</li>
<li> Accept that the <span class="inlinecode"><a class="idref" href="Grandpa.Blocks.Block.html#OriginBlock"><span class="id" title="constructor">OriginBlock</span></a></span> is already finalized 
    (and is the only block finalized).
    For this we accept that the <span class="inlinecode"><a class="idref" href="Grandpa.Blocks.Block.html#OriginBlock"><span class="id" title="constructor">OriginBlock</span></a></span> doesn't have to 
    have any precommit or prevote vote to be finalized and 
    is finalized before any round or time passes.
    As all participants would see the 0 round as completable all 
    of them would move immediately to the first round, and this 
    would look as if we finalized the <span class="inlinecode"><a class="idref" href="Grandpa.Blocks.Block.html#OriginBlock"><span class="id" title="constructor">OriginBlock</span></a></span> in the 0 round.

</li>
</ul>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="make_initial_state_from" class="idref" href="#make_initial_state_from"><span class="id" title="definition">make_initial_state_from</span></a> <br/>
&nbsp;&nbsp;(<a id="round_zero_dict:25" class="idref" href="#round_zero_dict:25"><span class="id" title="binder">round_zero_dict</span></a>: <a class="idref" href="Grandpa.DataTypes.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary.Dictionary</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="as_list:26" class="idref" href="#as_list:26"><span class="id" title="binder">as_list</span></a> :=<a class="idref" href="Grandpa.DataTypes.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_zero_dict:25"><span class="id" title="variable">round_zero_dict</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="total_voters:27" class="idref" href="#total_voters:27"><span class="id" title="binder">total_voters</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#length"><span class="id" title="abbreviation">List.length</span></a> <a class="idref" href="Grandpa.Protocol.State.html#as_list:26"><span class="id" title="variable">as_list</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.State.html#process_round_voters_from"><span class="id" title="definition">process_round_voters_from</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_zero_dict:25"><span class="id" title="variable">round_zero_dict</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">prevote_voters_list</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">precommit_voters_list</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="prevote_voters:28" class="idref" href="#prevote_voters:28"><span class="id" title="binder">prevote_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Voters.html#from_list"><span class="id" title="definition">Voters.from_list</span></a> <span class="id" title="var">prevote_voters_list</span> <a class="idref" href="Grandpa.Protocol.State.html#total_voters:27"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="precommit_voters:29" class="idref" href="#precommit_voters:29"><span class="id" title="binder">precommit_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Voters.html#from_list"><span class="id" title="definition">Voters.from_list</span></a> <span class="id" title="var">precommit_voters_list</span> <a class="idref" href="Grandpa.Protocol.State.html#total_voters:27"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="init_vs:30" class="idref" href="#init_vs:30"><span class="id" title="binder">init_vs</span></a>  := <a class="idref" href="Grandpa.VoterState.html#make_state_zero"><span class="id" title="definition">VoterState.make_state_zero</span></a> <a class="idref" href="Grandpa.Protocol.State.html#prevote_voters:28"><span class="id" title="variable">prevote_voters</span></a> <a class="idref" href="Grandpa.Protocol.State.html#precommit_voters:29"><span class="id" title="variable">precommit_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#message_count"><span class="id" title="projection">message_count</span></a>:=0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:= <a class="idref" href="Grandpa.DataTypes.Dictionary.html#empty"><span class="id" title="definition">Dictionary.empty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.DataTypes.Dictionary.html#from_list"><span class="id" title="definition">Dictionary.from_list</span></a> (<a class="idref" href="Grandpa.Classes.Functor.html#map"><span class="id" title="method">map</span></a> (<span class="id" title="keyword">fun</span> <a id="x:31" class="idref" href="#x:31"><span class="id" title="binder">x</span></a> ⇒<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Grandpa.Protocol.State.html#x:31"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Protocol.State.html#init_vs:30"><span class="id" title="variable">init_vs</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="Grandpa.Protocol.State.html#as_list:26"><span class="id" title="variable">as_list</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.State.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="origin_voters:32" class="idref" href="#origin_voters:32"><span class="id" title="binder">origin_voters</span></a> := <a class="idref" href="Grandpa.Voters.html#from_list"><span class="id" title="definition">Voters.from_list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">{|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#block"><span class="id" title="projection">FinalizedBlock.block</span></a> := <a class="idref" href="Grandpa.Blocks.AnyBlock.html#to_any"><span class="id" title="definition">AnyBlock.to_any</span></a> <a class="idref" href="Grandpa.Blocks.Block.html#OriginBlock"><span class="id" title="constructor">OriginBlock</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#time"><span class="id" title="projection">FinalizedBlock.time</span></a> := <a class="idref" href="Grandpa.Time.html#from_nat"><span class="id" title="definition">Time.from_nat</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#round_number"><span class="id" title="projection">FinalizedBlock.round_number</span></a> := <a class="idref" href="Grandpa.RoundNumber.html#from_nat"><span class="id" title="definition">RoundNumber.from_nat</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#submitter_voter"><span class="id" title="projection">FinalizedBlock.submitter_voter</span></a>:= <a class="idref" href="Grandpa.Voter.html#from_nat"><span class="id" title="definition">Voter.from_nat</span></a> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#voters"><span class="id" title="projection">FinalizedBlock.voters</span></a>:= <a class="idref" href="Grandpa.Protocol.State.html#origin_voters:32"><span class="id" title="variable">origin_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.FinalizedBlock.html#precommit_votes"><span class="id" title="projection">FinalizedBlock.precommit_votes</span></a>:= <a class="idref" href="Grandpa.Votes.html#VotesC"><span class="id" title="constructor">Votes.VotesC</span></a> <a class="idref" href="Grandpa.Protocol.State.html#origin_voters:32"><span class="id" title="variable">origin_voters</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">|}</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">math</span>.<br/>

<br/>
</div>

<div class="doc">
The function is here since we need the other functions processing the output 
  of the IO class to define it. 
We may move it to the <span class="inlinecode"><a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a></span> module in the future.

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a id="init_next_round_voter_state_from" class="idref" href="#init_next_round_voter_state_from"><span class="id" title="definition">init_next_round_voter_state_from</span></a> <br/>
&nbsp;&nbsp;(<a id="round_dictionary:33" class="idref" href="#round_dictionary:33"><span class="id" title="binder">round_dictionary</span></a>: <a class="idref" href="Grandpa.DataTypes.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary</span></a> <a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a>)<br/>
&nbsp;&nbsp;(<a id="time:34" class="idref" href="#time:34"><span class="id" title="binder">time</span></a>:<a class="idref" href="Grandpa.Time.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="vs:35" class="idref" href="#vs:35"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a> <br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="round_number:36" class="idref" href="#round_number:36"><span class="id" title="binder">round_number</span></a> : <a class="idref" href="Grandpa.RoundNumber.html#RoundNumber"><span class="id" title="definition">RoundNumber</span></a> := (<a class="idref" href="Grandpa.Classes.Math.Semigroup.html#bd0dc97a35a215d97e8a463a14f0b420"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.RoundNumber.html#from_nat"><span class="id" title="definition">RoundNumber.from_nat</span></a> 1<a class="idref" href="Grandpa.Classes.Math.Semigroup.html#bd0dc97a35a215d97e8a463a14f0b420"><span class="id" title="notation">)</span></a> <a class="idref" href="Grandpa.Classes.Math.Semigroup.html#bd0dc97a35a215d97e8a463a14f0b420"><span class="id" title="notation">+</span></a> <a class="idref" href="Grandpa.Protocol.State.html#vs:35"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>))%<span class="id" title="var">math</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="total_voters:37" class="idref" href="#total_voters:37"><span class="id" title="binder">total_voters</span></a> := <a class="idref" href="Grandpa.Protocol.State.html#get_round_total_voters_from"><span class="id" title="definition">get_round_total_voters_from</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_dictionary:33"><span class="id" title="variable">round_dictionary</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.State.html#process_round_voters_from"><span class="id" title="definition">process_round_voters_from</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_dictionary:33"><span class="id" title="variable">round_dictionary</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">prevote_voters_list</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">precommit_voters_list</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="prevote_voters:38" class="idref" href="#prevote_voters:38"><span class="id" title="binder">prevote_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Voters.html#from_list"><span class="id" title="definition">Voters.from_list</span></a> <span class="id" title="var">prevote_voters_list</span> <a class="idref" href="Grandpa.Protocol.State.html#total_voters:37"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="precommit_voters:39" class="idref" href="#precommit_voters:39"><span class="id" title="binder">precommit_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Voters.html#from_list"><span class="id" title="definition">Voters.from_list</span></a> <span class="id" title="var">precommit_voters_list</span> <a class="idref" href="Grandpa.Protocol.State.html#total_voters:37"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="round:40" class="idref" href="#round:40"><span class="id" title="binder">round</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a>(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Round.html#InitialRoundState"><span class="id" title="constructor">Round.InitialRoundState</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#total_voters:37"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#prevote_voters:38"><span class="id" title="variable">prevote_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#precommit_voters:39"><span class="id" title="variable">precommit_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#time:34"><span class="id" title="variable">time</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#round_number:36"><span class="id" title="variable">round_number</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="rounds:41" class="idref" href="#rounds:41"><span class="id" title="binder">rounds</span></a> : <a class="idref" href="Grandpa.DataTypes.Vectors.html#Vec"><span class="id" title="definition">Vectors.Vec</span></a> <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a> ( 1 <a class="idref" href="Grandpa.Classes.Math.Semigroup.html#bd0dc97a35a215d97e8a463a14f0b420"><span class="id" title="notation">+</span></a> <a class="idref" href="Grandpa.RoundNumber.html#to_nat"><span class="id" title="definition">RoundNumber.to_nat</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_number:36"><span class="id" title="variable">round_number</span></a> )%<span class="id" title="var">math</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Vectors.VectorDef.html#cons"><span class="id" title="constructor">Coq.Vectors.VectorDef.cons</span></a> <span class="id" title="var">_</span> <a class="idref" href="Grandpa.Protocol.State.html#round:40"><span class="id" title="variable">round</span></a> <span class="id" title="var">_</span> <a class="idref" href="Grandpa.Protocol.State.html#vs:35"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">rounds</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span>  <a id="voter_state:42" class="idref" href="#voter_state:42"><span class="id" title="binder">voter_state</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a> := <a class="idref" href="Grandpa.Protocol.State.html#round_number:36"><span class="id" title="variable">round_number</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#prevoted_block"><span class="id" title="projection">prevoted_block</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#precommited_block"><span class="id" title="projection">precommited_block</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#last_brodcasted_block"><span class="id" title="projection">last_brodcasted_block</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">rounds</span></a> :=  <a class="idref" href="Grandpa.Protocol.State.html#rounds:41"><span class="id" title="variable">rounds</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#pending_messages"><span class="id" title="projection">VoterState.pending_messages</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Protocol.State.html#vs:35"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#pending_messages"><span class="id" title="projection">VoterState.pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#finalized_blocks"><span class="id" title="projection">VoterState.finalized_blocks</span></a> := <a class="idref" href="Grandpa.Protocol.State.html#vs:35"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#finalized_blocks"><span class="id" title="projection">VoterState.finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.DataTypes.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <a class="idref" href="Grandpa.Protocol.State.html#round_number:36"><span class="id" title="variable">round_number</span></a> <a class="idref" href="Grandpa.Protocol.State.html#vs:35"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#pending_messages"><span class="id" title="projection">VoterState.pending_messages</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">pending</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.VoterState.html#update_with_msg"><span class="id" title="definition">update_with_msg</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pending</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.State.html#voter_state:42"><span class="id" title="variable">voter_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.State.html#voter_state:42"><span class="id" title="variable">voter_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Grandpa.Protocol.State.html#ProcessIo"><span class="id" title="section">ProcessIo</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_voter_opaque_round" class="idref" href="#get_voter_opaque_round"><span class="id" title="definition">get_voter_opaque_round</span></a> (<a id="state:43" class="idref" href="#state:43"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.State.html#State"><span class="id" title="record">State</span></a>) (<a id="v:44" class="idref" href="#v:44"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Voter.html#Voter"><span class="id" title="record">Voter</span></a>) (<a id="r_n:45" class="idref" href="#r_n:45"><span class="id" title="binder">r_n</span></a>:<a class="idref" href="Grandpa.RoundNumber.html#RoundNumber"><span class="id" title="definition">RoundNumber</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a> <br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="Grandpa.DataTypes.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <a class="idref" href="Grandpa.Protocol.State.html#v:44"><span class="id" title="variable">v</span></a> (<a class="idref" href="Grandpa.Protocol.State.html#voters_state"><span class="id" title="projection">voters_state</span></a> <a class="idref" href="Grandpa.Protocol.State.html#state:43"><span class="id" title="variable">state</span></a>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;|<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">vs</span> ⇒ <a class="idref" href="Grandpa.DataTypes.Vectors.html#get"><span class="id" title="definition">Vectors.get</span></a> <span class="id" title="var">vs</span>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">VoterState.rounds</span></a>) (<a class="idref" href="Grandpa.RoundNumber.html#to_nat"><span class="id" title="definition">RoundNumber.to_nat</span></a> <a class="idref" href="Grandpa.Protocol.State.html#r_n:45"><span class="id" title="variable">r_n</span></a>) <br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>