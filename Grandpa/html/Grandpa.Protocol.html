<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Grandpa.Protocol</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Grandpa.Protocol</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Blocks.html#"><span class="id" title="library">Blocks</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Votes.html#"><span class="id" title="library">Votes</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Preliminars.html#"><span class="id" title="library">Preliminars</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Round.html#"><span class="id" title="library">Round</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Estimate.html#"><span class="id" title="library">Estimate</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.VoterState.html#"><span class="id" title="library">VoterState</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Message.html#"><span class="id" title="library">Message</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Functors.html#"><span class="id" title="library">Functors</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Vectors.html#"><span class="id" title="library">Vectors</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Grandpa.Sets.html#"><span class="id" title="library">Sets</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#"><span class="id" title="library">Nat</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Program.Equality.html#"><span class="id" title="library">Program.Equality</span></a>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <a id="Io" class="idref" href="#Io"><span class="id" title="record">Io</span></a> := {<br/>
&nbsp;&nbsp;<a id="global_time_constant" class="idref" href="#global_time_constant"><span class="id" title="projection">global_time_constant</span></a>: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>;<br/>
&nbsp;&nbsp;<a id="block_producer" class="idref" href="#block_producer"><span class="id" title="projection">block_producer</span></a> (<a id="time:3" class="idref" href="#time:3"><span class="id" title="binder">time</span></a> <a id="voter:4" class="idref" href="#voter:4"><span class="id" title="binder">voter</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Sets.html#DictionarySet"><span class="id" title="inductive">Sets.DictionarySet</span></a> <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>;<br/>
&nbsp;&nbsp;<a id="io_accept_vote" class="idref" href="#io_accept_vote"><span class="id" title="projection">io_accept_vote</span></a> : <a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<a id="io_bizantine_vote" class="idref" href="#io_bizantine_vote"><span class="id" title="projection">io_bizantine_vote</span></a> : <a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>;<br/>
&nbsp;&nbsp;<a id="io_bizantine_advance_round" class="idref" href="#io_bizantine_advance_round"><span class="id" title="projection">io_bizantine_advance_round</span></a> : <a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>;<br/>
&nbsp;&nbsp;<a id="io_get_round_voters" class="idref" href="#io_get_round_voters"><span class="id" title="projection">io_get_round_voters</span></a>:  <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary.Dictionary</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a>;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<a id="io_get_round_primary" class="idref" href="#io_get_round_primary"><span class="id" title="projection">io_get_round_primary</span></a> : <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<a id="block_producer_not_emtpy" class="idref" href="#block_producer_not_emtpy"><span class="id" title="projection">block_producer_not_emtpy</span></a> <br/>
&nbsp;&nbsp;:<span class="id" title="keyword">∀</span> <a id="t:11" class="idref" href="#t:11"><span class="id" title="binder">t</span></a> <a id="v:12" class="idref" href="#v:12"><span class="id" title="binder">v</span></a>, <a class="idref" href="Grandpa.Sets.html#is_empty"><span class="id" title="definition">Sets.is_empty</span></a> (<a class="idref" href="Grandpa.Protocol.html#block_producer:5"><span class="id" title="method">block_producer</span></a> <a class="idref" href="Grandpa.Protocol.html#t:11"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#v:12"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>;<br/>
&nbsp;&nbsp;<a id="primary_consistent" class="idref" href="#primary_consistent"><span class="id" title="projection">primary_consistent</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> <a id="r:14" class="idref" href="#r:14"><span class="id" title="binder">r</span></a> , <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">List.In</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#io_get_round_primary:10"><span class="id" title="method">io_get_round_primary</span></a> <a class="idref" href="Grandpa.Protocol.html#r:14"><span class="id" title="variable">r</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> (<a class="idref" href="Grandpa.Protocol.html#io_get_round_voters:9"><span class="id" title="method">io_get_round_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#r:14"><span class="id" title="variable">r</span></a> )));<br/>
}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="voter_is_primary_for_round" class="idref" href="#voter_is_primary_for_round"><span class="id" title="definition">voter_is_primary_for_round</span></a> `{<a id="H:16" class="idref" href="#H:16"><span class="id" title="binder">Io</span></a>} (<a id="v:17" class="idref" href="#v:17"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="round_number:18" class="idref" href="#round_number:18"><span class="id" title="binder">round_number</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>):<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#io_get_round_primary"><span class="id" title="method">io_get_round_primary</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:18"><span class="id" title="variable">round_number</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <a class="idref" href="Grandpa.Protocol.html#v:17"><span class="id" title="variable">v</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_round_bizantine_voters" class="idref" href="#get_round_bizantine_voters"><span class="id" title="definition">get_round_bizantine_voters</span></a> `{<a id="H:19" class="idref" href="#H:19"><span class="id" title="binder">Io</span></a>} (<a id="round_number:20" class="idref" href="#round_number:20"><span class="id" title="binder">round_number</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="f:23" class="idref" href="#f:23"><span class="id" title="binder">f</span></a> <a id="v_k:21" class="idref" href="#v_k:21"><span class="id" title="binder">v_k</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#v_k:21"><span class="id" title="variable">v_k</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">Bizantine</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Functors.html#map"><span class="id" title="method">map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a>  (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">List.filter</span></a> <a class="idref" href="Grandpa.Protocol.html#f:23"><span class="id" title="variable">f</span></a> (<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> (<a class="idref" href="Grandpa.Protocol.html#io_get_round_voters"><span class="id" title="method">io_get_round_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:20"><span class="id" title="variable">round_number</span></a>)) ).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="process_round_voters_step" class="idref" href="#process_round_voters_step"><span class="id" title="definition">process_round_voters_step</span></a> <br/>
&nbsp;&nbsp;(<a id="acc:24" class="idref" href="#acc:24"><span class="id" title="binder">acc</span></a>: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">)*(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">)</span></a> )<br/>
&nbsp;&nbsp;(<a id="value:25" class="idref" href="#value:25"><span class="id" title="binder">value</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a>)<br/>
&nbsp;&nbsp;: (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>)<br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#acc:24"><span class="id" title="variable">acc</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#value:25"><span class="id" title="variable">value</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">kind</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">kind</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">Bizantine</span></a> <a class="idref" href="Grandpa.VoterState.html#VotePrevote"><span class="id" title="constructor">VotePrevote</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">Bizantine</span></a> <a class="idref" href="Grandpa.VoterState.html#VotePrecommit"><span class="id" title="constructor">VotePrecommit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">Bizantine</span></a> <a class="idref" href="Grandpa.VoterState.html#VoteBoth"><span class="id" title="constructor">VoteBoth</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Honest"><span class="id" title="constructor">Honest</span></a> <a class="idref" href="Grandpa.VoterState.html#VotePrevote"><span class="id" title="constructor">VotePrevote</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Honest"><span class="id" title="constructor">Honest</span></a> <a class="idref" href="Grandpa.VoterState.html#VotePrecommit"><span class="id" title="constructor">VotePrecommit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Honest"><span class="id" title="constructor">Honest</span></a> <a class="idref" href="Grandpa.VoterState.html#VoteBoth"><span class="id" title="constructor">VoteBoth</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">prevote_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">voter</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><span class="id" title="var">precommit_voters</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="process_round_voters" class="idref" href="#process_round_voters"><span class="id" title="definition">process_round_voters</span></a> `{<a id="H:29" class="idref" href="#H:29"><span class="id" title="binder">Io</span></a>} (<a id="r:30" class="idref" href="#r:30"><span class="id" title="binder">r</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>)<br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="as_list:31" class="idref" href="#as_list:31"><span class="id" title="binder">as_list</span></a> :=<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> (<a class="idref" href="Grandpa.Protocol.html#io_get_round_voters"><span class="id" title="method">io_get_round_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#r:30"><span class="id" title="variable">r</span></a>) <br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <a class="idref" href="Grandpa.Protocol.html#process_round_voters_step"><span class="id" title="definition">process_round_voters_step</span></a> <a class="idref" href="Grandpa.Protocol.html#as_list:31"><span class="id" title="variable">as_list</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_round_total_voters" class="idref" href="#get_round_total_voters"><span class="id" title="definition">get_round_total_voters</span></a> `{<a id="H:32" class="idref" href="#H:32"><span class="id" title="binder">Io</span></a>} (<a id="round_number:33" class="idref" href="#round_number:33"><span class="id" title="binder">round_number</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> (<a class="idref" href="Grandpa.Protocol.html#io_get_round_voters"><span class="id" title="method">io_get_round_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:33"><span class="id" title="variable">round_number</span></a>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_round_bizantiners_number" class="idref" href="#get_round_bizantiners_number"><span class="id" title="definition">get_round_bizantiners_number</span></a> `{<a id="H:34" class="idref" href="#H:34"><span class="id" title="binder">Io</span></a>} (<a id="round_number:35" class="idref" href="#round_number:35"><span class="id" title="binder">round_number</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#process_round_voters"><span class="id" title="definition">process_round_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:35"><span class="id" title="variable">round_number</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒ <span class="id" title="var">bizantiners_number</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="init_next_round_voter_state" class="idref" href="#init_next_round_voter_state"><span class="id" title="definition">init_next_round_voter_state</span></a> `{<a id="H:36" class="idref" href="#H:36"><span class="id" title="binder">Io</span></a>}<br/>
&nbsp;&nbsp;(<a id="time:37" class="idref" href="#time:37"><span class="id" title="binder">time</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="vs:38" class="idref" href="#vs:38"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a> <br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="round_number:39" class="idref" href="#round_number:39"><span class="id" title="binder">round_number</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:38"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="total_voters:40" class="idref" href="#total_voters:40"><span class="id" title="binder">total_voters</span></a> := <a class="idref" href="Grandpa.Protocol.html#get_round_total_voters"><span class="id" title="definition">get_round_total_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:39"><span class="id" title="variable">round_number</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#process_round_voters"><span class="id" title="definition">process_round_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:39"><span class="id" title="variable">round_number</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">prevote_voters_list</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">precommit_voters_list</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="prevote_voters:41" class="idref" href="#prevote_voters:41"><span class="id" title="binder">prevote_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Votes.html#voters_from_list"><span class="id" title="definition">Votes.voters_from_list</span></a> <span class="id" title="var">prevote_voters_list</span> <a class="idref" href="Grandpa.Protocol.html#total_voters:40"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="precommit_voters:42" class="idref" href="#precommit_voters:42"><span class="id" title="binder">precommit_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Votes.html#voters_from_list"><span class="id" title="definition">Votes.voters_from_list</span></a> <span class="id" title="var">precommit_voters_list</span> <a class="idref" href="Grandpa.Protocol.html#total_voters:40"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="round:43" class="idref" href="#round:43"><span class="id" title="binder">round</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a>(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Round.html#InitialRoundState"><span class="id" title="constructor">InitialRoundState</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#total_voters:40"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#prevote_voters:41"><span class="id" title="variable">prevote_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#precommit_voters:42"><span class="id" title="variable">precommit_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#time:37"><span class="id" title="variable">time</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#round_number:39"><span class="id" title="variable">round_number</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="rounds:44" class="idref" href="#rounds:44"><span class="id" title="binder">rounds</span></a> : <a class="idref" href="Grandpa.Vectors.html#Vec"><span class="id" title="definition">Vectors.Vec</span></a> <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:39"><span class="id" title="variable">round_number</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Vectors.VectorDef.html#cons"><span class="id" title="constructor">Coq.Vectors.VectorDef.cons</span></a> <span class="id" title="var">_</span> <a class="idref" href="Grandpa.Protocol.html#round:43"><span class="id" title="variable">round</span></a> <span class="id" title="var">_</span> <a class="idref" href="Grandpa.Protocol.html#vs:38"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">rounds</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span>  <a id="voter_state:45" class="idref" href="#voter_state:45"><span class="id" title="binder">voter_state</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">round_number</span></a> := <a class="idref" href="Grandpa.Protocol.html#round_number:39"><span class="id" title="variable">round_number</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#prevoted_block"><span class="id" title="projection">prevoted_block</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#precommited_block"><span class="id" title="projection">precommited_block</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#last_brodcasted_block"><span class="id" title="projection">last_brodcasted_block</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">rounds</span></a> :=  <a class="idref" href="Grandpa.Protocol.html#rounds:44"><span class="id" title="variable">rounds</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#pending_messages"><span class="id" title="projection">pending_messages</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Protocol.html#vs:38"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.VoterState.html#finalized_blocks"><span class="id" title="projection">finalized_blocks</span></a> := <a class="idref" href="Grandpa.Protocol.html#vs:38"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#finalized_blocks"><span class="id" title="projection">finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:39"><span class="id" title="variable">round_number</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:38"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">pending</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.VoterState.html#update_with_msg"><span class="id" title="definition">update_with_msg</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pending</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#voter_state:45"><span class="id" title="variable">voter_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#voter_state:45"><span class="id" title="variable">voter_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <a id="State" class="idref" href="#State"><span class="id" title="record">State</span></a> :={<br/>
&nbsp;&nbsp;<a id="message_count" class="idref" href="#message_count"><span class="id" title="projection">message_count</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;;<a id="pending_messages" class="idref" href="#pending_messages"><span class="id" title="projection">pending_messages</span></a>:<a class="idref" href="Grandpa.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary.Dictionary</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a> <br/>
&nbsp;&nbsp;;<a id="voters_state" class="idref" href="#voters_state"><span class="id" title="projection">voters_state</span></a>:<a class="idref" href="Grandpa.Dictionary.html#Dictionary"><span class="id" title="inductive">Dictionary.Dictionary</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a><br/>
&nbsp;&nbsp;;<a id="global_finalized_blocks" class="idref" href="#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="empty_state" class="idref" href="#empty_state"><span class="id" title="definition">empty_state</span></a> : <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>:=0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#empty"><span class="id" title="definition">Dictionary.empty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#empty"><span class="id" title="definition">Dictionary.empty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a><br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="update_message" class="idref" href="#update_message"><span class="id" title="definition">update_message</span></a> (<a id="state:51" class="idref" href="#state:51"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="msg:52" class="idref" href="#msg:52"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>) : <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:51"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#add"><span class="id" title="definition">Dictionary.add</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:52"><span class="id" title="variable">msg</span></a>.(<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>) <a class="idref" href="Grandpa.Protocol.html#msg:52"><span class="id" title="variable">msg</span></a> <a class="idref" href="Grandpa.Protocol.html#state:51"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:51"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:51"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="advance_count" class="idref" href="#advance_count"><span class="id" title="definition">advance_count</span></a> (<a id="state:53" class="idref" href="#state:53"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Grandpa.Protocol.html#state:53"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:= <a class="idref" href="Grandpa.Protocol.html#state:53"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:53"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:53"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="update_voter_state" class="idref" href="#update_voter_state"><span class="id" title="definition">update_voter_state</span></a> (<a id="state:54" class="idref" href="#state:54"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="voter:55" class="idref" href="#voter:55"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="vs:56" class="idref" href="#vs:56"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>) : <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:54"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:54"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#add"><span class="id" title="definition">Dictionary.add</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:55"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:56"><span class="id" title="variable">vs</span></a> <a class="idref" href="Grandpa.Protocol.html#state:54"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:54"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="make_initial_state" class="idref" href="#make_initial_state"><span class="id" title="definition">make_initial_state</span></a> `{<a id="H:57" class="idref" href="#H:57"><span class="id" title="binder">Io</span></a>}<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="as_list:58" class="idref" href="#as_list:58"><span class="id" title="binder">as_list</span></a> :=<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> (<a class="idref" href="Grandpa.Protocol.html#io_get_round_voters"><span class="id" title="method">io_get_round_voters</span></a> 0) <br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="total_voters:59" class="idref" href="#total_voters:59"><span class="id" title="binder">total_voters</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Grandpa.Protocol.html#as_list:58"><span class="id" title="variable">as_list</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#process_round_voters"><span class="id" title="definition">process_round_voters</span></a> 1 <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">bizantiners_number</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">prevote_voters_list</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">precommit_voters_list</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="prevote_voters:60" class="idref" href="#prevote_voters:60"><span class="id" title="binder">prevote_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Votes.html#voters_from_list"><span class="id" title="definition">Votes.voters_from_list</span></a> <span class="id" title="var">prevote_voters_list</span> <a class="idref" href="Grandpa.Protocol.html#total_voters:59"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="precommit_voters:61" class="idref" href="#precommit_voters:61"><span class="id" title="binder">precommit_voters</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Grandpa.Votes.html#voters_from_list"><span class="id" title="definition">Votes.voters_from_list</span></a> <span class="id" title="var">precommit_voters_list</span> <a class="idref" href="Grandpa.Protocol.html#total_voters:59"><span class="id" title="variable">total_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="init_vs:62" class="idref" href="#init_vs:62"><span class="id" title="binder">init_vs</span></a>  := <a class="idref" href="Grandpa.VoterState.html#make_initial_voter_state"><span class="id" title="definition">VoterState.make_initial_voter_state</span></a> <a class="idref" href="Grandpa.Protocol.html#prevote_voters:60"><span class="id" title="variable">prevote_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#precommit_voters:61"><span class="id" title="variable">precommit_voters</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>:=0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:= <a class="idref" href="Grandpa.Dictionary.html#empty"><span class="id" title="definition">Dictionary.empty</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Dictionary.html#from_list"><span class="id" title="definition">Dictionary.from_list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> (<a class="idref" href="Grandpa.Functors.html#map"><span class="id" title="method">map</span></a> (<span class="id" title="keyword">fun</span> <a id="x:63" class="idref" href="#x:63"><span class="id" title="binder">x</span></a> ⇒<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Grandpa.Protocol.html#x:63"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Protocol.html#init_vs:62"><span class="id" title="variable">init_vs</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <a class="idref" href="Grandpa.Protocol.html#as_list:58"><span class="id" title="variable">as_list</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:= <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Blocks.html#to_any"><span class="id" title="definition">Blocks.to_any</span></a> <a class="idref" href="Grandpa.Blocks.html#OriginBlock"><span class="id" title="constructor">OriginBlock</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>0<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>0<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="remove_message" class="idref" href="#remove_message"><span class="id" title="definition">remove_message</span></a> (<a id="state:64" class="idref" href="#state:64"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="msg:65" class="idref" href="#msg:65"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>): <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:64"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#delete"><span class="id" title="definition">Dictionary.delete</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:65"><span class="id" title="variable">msg</span></a>.(<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>) <a class="idref" href="Grandpa.Protocol.html#state:64"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:64"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>:=<a class="idref" href="Grandpa.Protocol.html#state:64"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;|}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="set_as_processed_by" class="idref" href="#set_as_processed_by"><span class="id" title="definition">set_as_processed_by</span></a> (<a id="v:66" class="idref" href="#v:66"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="msg:67" class="idref" href="#msg:67"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>) (<a id="state:68" class="idref" href="#state:68"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>): <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#update_message"><span class="id" title="definition">update_message</span></a> <a class="idref" href="Grandpa.Protocol.html#state:68"><span class="id" title="variable">state</span></a> (<a class="idref" href="Grandpa.Message.html#update_message_proccessed"><span class="id" title="definition">Message.update_message_proccessed</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:67"><span class="id" title="variable">msg</span></a> <a class="idref" href="Grandpa.Protocol.html#v:66"><span class="id" title="variable">v</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_processed_by" class="idref" href="#is_processed_by"><span class="id" title="definition">is_processed_by</span></a>(<a id="state:69" class="idref" href="#state:69"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="msg:70" class="idref" href="#msg:70"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>) (<a id="v:71" class="idref" href="#v:71"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:70"><span class="id" title="variable">msg</span></a>.(<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>) <a class="idref" href="Grandpa.Protocol.html#state:69"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="accept_vote" class="idref" href="#accept_vote"><span class="id" title="definition">accept_vote</span></a> (<a id="state:72" class="idref" href="#state:72"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="voter:73" class="idref" href="#voter:73"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="msg:74" class="idref" href="#msg:74"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>): <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:73"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#state:72"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">voter_state_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#update_voter_state"><span class="id" title="definition">update_voter_state</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#state:72"><span class="id" title="variable">state</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#voter:73"><span class="id" title="variable">voter</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.VoterState.html#update_with_msg"><span class="id" title="definition">VoterState.update_with_msg</span></a> <span class="id" title="var">voter_state_</span> <a class="idref" href="Grandpa.Protocol.html#msg:74"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:72"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="update_vote_for_voter" class="idref" href="#update_vote_for_voter"><span class="id" title="definition">update_vote_for_voter</span></a> `{<a id="H:75" class="idref" href="#H:75"><span class="id" title="binder">Io</span></a>} (<a id="t:76" class="idref" href="#t:76"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="voter:77" class="idref" href="#voter:77"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="state:78" class="idref" href="#state:78"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="msg:79" class="idref" href="#msg:79"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>) : <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Grandpa.Protocol.html#is_processed_by"><span class="id" title="definition">is_processed_by</span></a> <a class="idref" href="Grandpa.Protocol.html#state:78"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:79"><span class="id" title="variable">msg</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:77"><span class="id" title="variable">voter</span></a> <span class="id" title="keyword">then</span>  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#state:78"><span class="id" title="variable">state</span></a> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Grandpa.Protocol.html#io_accept_vote"><span class="id" title="method">io_accept_vote</span></a> <a class="idref" href="Grandpa.Protocol.html#t:76"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:79"><span class="id" title="variable">msg</span></a>  <a class="idref" href="Grandpa.Protocol.html#voter:77"><span class="id" title="variable">voter</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#accept_vote"><span class="id" title="definition">accept_vote</span></a> <a class="idref" href="Grandpa.Protocol.html#state:78"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:77"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:79"><span class="id" title="variable">msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#leb"><span class="id" title="definition">Nat.leb</span></a> <a class="idref" href="Grandpa.Protocol.html#t:76"><span class="id" title="variable">t</span></a> (<a class="idref" href="Grandpa.Protocol.html#msg:79"><span class="id" title="variable">msg</span></a>.(<a class="idref" href="Grandpa.Message.html#time"><span class="id" title="projection">Message.time</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Grandpa.Protocol.html#global_time_constant"><span class="id" title="method">global_time_constant</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Protocol.html#voter:77"><span class="id" title="variable">voter</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:79"><span class="id" title="variable">msg</span></a>.(<a class="idref" href="Grandpa.Message.html#voter"><span class="id" title="projection">Message.voter</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="Grandpa.Protocol.html#accept_vote"><span class="id" title="definition">accept_vote</span></a> <a class="idref" href="Grandpa.Protocol.html#state:78"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:77"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:79"><span class="id" title="variable">msg</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Grandpa.Protocol.html#state:78"><span class="id" title="variable">state</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="upate_votes_for_voter" class="idref" href="#upate_votes_for_voter"><span class="id" title="definition">upate_votes_for_voter</span></a> `{<a id="H:80" class="idref" href="#H:80"><span class="id" title="binder">Io</span></a>} (<a id="t:81" class="idref" href="#t:81"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="state:82" class="idref" href="#state:82"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="voter:83" class="idref" href="#voter:83"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) : <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="messages:84" class="idref" href="#messages:84"><span class="id" title="binder">messages</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> (<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a> <a class="idref" href="Grandpa.Protocol.html#state:82"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="f:85" class="idref" href="#f:85"><span class="id" title="binder">f</span></a> := <a class="idref" href="Grandpa.Protocol.html#update_vote_for_voter"><span class="id" title="definition">update_vote_for_voter</span></a> <a class="idref" href="Grandpa.Protocol.html#t:81"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:83"><span class="id" title="variable">voter</span></a> <br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <a class="idref" href="Grandpa.Protocol.html#f:85"><span class="id" title="variable">f</span></a> <a class="idref" href="Grandpa.Protocol.html#messages:84"><span class="id" title="variable">messages</span></a> <a class="idref" href="Grandpa.Protocol.html#state:82"><span class="id" title="variable">state</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prune_message" class="idref" href="#prune_message"><span class="id" title="definition">prune_message</span></a> `{<a id="H:86" class="idref" href="#H:86"><span class="id" title="binder">Io</span></a>} (<a id="state:87" class="idref" href="#state:87"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="msg:88" class="idref" href="#msg:88"><span class="id" title="binder">msg</span></a>:<a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message</span></a>) : <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="round_participants:89" class="idref" href="#round_participants:89"><span class="id" title="binder">round_participants</span></a> := <a class="idref" href="Grandpa.Protocol.html#io_get_round_voters"><span class="id" title="method">io_get_round_voters</span></a> (<a class="idref" href="Grandpa.Message.html#round"><span class="id" title="projection">Message.round</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:88"><span class="id" title="variable">msg</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="acc:90" class="idref" href="#acc:90"><span class="id" title="binder">acc</span></a> <a id="v:91" class="idref" href="#v:91"><span class="id" title="binder">v</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Grandpa.Protocol.html#acc:90"><span class="id" title="variable">acc</span></a> (<a class="idref" href="Grandpa.Protocol.html#is_processed_by"><span class="id" title="definition">is_processed_by</span></a> <a class="idref" href="Grandpa.Protocol.html#state:87"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:88"><span class="id" title="variable">msg</span></a> <a class="idref" href="Grandpa.Protocol.html#v:91"><span class="id" title="variable">v</span></a>) ) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> <a class="idref" href="Grandpa.Protocol.html#round_participants:89"><span class="id" title="variable">round_participants</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#remove_message"><span class="id" title="definition">remove_message</span></a> <a class="idref" href="Grandpa.Protocol.html#state:87"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#msg:88"><span class="id" title="variable">msg</span></a> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#state:87"><span class="id" title="variable">state</span></a> .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prune_messages" class="idref" href="#prune_messages"><span class="id" title="definition">prune_messages</span></a> `{<a id="H:92" class="idref" href="#H:92"><span class="id" title="binder">Io</span></a>} (<a id="state:93" class="idref" href="#state:93"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>): <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>:=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <a class="idref" href="Grandpa.Protocol.html#prune_message"><span class="id" title="definition">prune_message</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> (<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> <a class="idref" href="Grandpa.Protocol.html#state:93"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#pending_messages"><span class="id" title="projection">pending_messages</span></a>)) ) <a class="idref" href="Grandpa.Protocol.html#state:93"><span class="id" title="variable">state</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="update_votes" class="idref" href="#update_votes"><span class="id" title="definition">update_votes</span></a> `{<a id="H:94" class="idref" href="#H:94"><span class="id" title="binder">Io</span></a>} (<a id="t:95" class="idref" href="#t:95"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="state:96" class="idref" href="#state:96"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) : <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="state_votes_updated:97" class="idref" href="#state_votes_updated:97"><span class="id" title="binder">state_votes_updated</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#upate_votes_for_voter"><span class="id" title="definition">upate_votes_for_voter</span></a> <a class="idref" href="Grandpa.Protocol.html#t:95"><span class="id" title="variable">t</span></a> ) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> <a class="idref" href="Grandpa.Protocol.html#state:96"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#state:96"><span class="id" title="variable">state</span></a> <br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#prune_messages"><span class="id" title="definition">prune_messages</span></a> <a class="idref" href="Grandpa.Protocol.html#state_votes_updated:97"><span class="id" title="variable">state_votes_updated</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="look_for_best_chain_for_block" class="idref" href="#look_for_best_chain_for_block"><span class="id" title="definition">look_for_best_chain_for_block</span></a> `{<a id="H:98" class="idref" href="#H:98"><span class="id" title="binder">Io</span></a>} (<a id="t:99" class="idref" href="#t:99"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="v:100" class="idref" href="#v:100"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="ablock:101" class="idref" href="#ablock:101"><span class="id" title="binder">ablock</span></a>:<a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="block_number:102" class="idref" href="#block_number:102"><span class="id" title="binder">block_number</span></a>,<a id="block:103" class="idref" href="#block:103"><span class="id" title="binder">block</span></a>) := <a class="idref" href="Grandpa.Protocol.html#ablock:101"><span class="id" title="variable">ablock</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="available_blocks:104" class="idref" href="#available_blocks:104"><span class="id" title="binder">available_blocks</span></a> := <a class="idref" href="Grandpa.Protocol.html#block_producer"><span class="id" title="method">block_producer</span></a> <a class="idref" href="Grandpa.Protocol.html#t:99"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#v:100"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="x:106" class="idref" href="#x:106"><span class="id" title="binder">x</span></a> <a id="y:107" class="idref" href="#y:107"><span class="id" title="binder">y</span></a> ⇒ <span class="id" title="keyword">if</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT1"><span class="id" title="definition">projT1</span></a> <a class="idref" href="Grandpa.Protocol.html#x:106"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT1"><span class="id" title="definition">projT1</span></a> <a class="idref" href="Grandpa.Protocol.html#y:107"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Grandpa.Protocol.html#y:107"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Grandpa.Protocol.html#x:106"><span class="id" title="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">List.filter</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="x:105" class="idref" href="#x:105"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="Grandpa.Blocks.html#is_prefix"><span class="id" title="definition">Blocks.is_prefix</span></a> <a class="idref" href="Grandpa.Protocol.html#block:103"><span class="id" title="variable">block</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <a class="idref" href="Grandpa.Protocol.html#x:105"><span class="id" title="variable">x</span></a>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Sets.html#to_list"><span class="id" title="definition">Sets.to_list</span></a> <a class="idref" href="Grandpa.Protocol.html#available_blocks:104"><span class="id" title="variable">available_blocks</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#existT"><span class="id" title="constructor">existT</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="Grandpa.Blocks.html#OriginBlock"><span class="id" title="constructor">OriginBlock</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="build_and_send_prevote" class="idref" href="#build_and_send_prevote"><span class="id" title="definition">build_and_send_prevote</span></a><br/>
&nbsp;&nbsp;(<a id="t:108" class="idref" href="#t:108"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="state:109" class="idref" href="#state:109"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:110" class="idref" href="#voter:110"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="vs:111" class="idref" href="#vs:111"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;(<a id="b:112" class="idref" href="#b:112"><span class="id" title="binder">b</span></a>:<a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="new_message:113" class="idref" href="#new_message:113"><span class="id" title="binder">new_message</span></a> : <a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message.Message</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>:= <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Grandpa.Protocol.html#state:109"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#block"><span class="id" title="projection">Message.block</span></a>:=<a class="idref" href="Grandpa.Protocol.html#b:112"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#kind"><span class="id" title="projection">kind</span></a>:=<a class="idref" href="Grandpa.Message.html#PreVoteMessage"><span class="id" title="constructor">Message.PreVoteMessage</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#round"><span class="id" title="projection">round</span></a>:=<a class="idref" href="Grandpa.Protocol.html#vs:111"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#time"><span class="id" title="projection">time</span></a>:=<a class="idref" href="Grandpa.Protocol.html#t:108"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#voter"><span class="id" title="projection">voter</span></a>:=<a class="idref" href="Grandpa.Protocol.html#voter:110"><span class="id" title="variable">voter</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#processed_by"><span class="id" title="projection">processed_by</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#from_list"><span class="id" title="definition">Dictionary.from_list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Protocol.html#voter:110"><span class="id" title="variable">voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Sets.html#UnitC"><span class="id" title="constructor">UnitC</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="up_prevote:114" class="idref" href="#up_prevote:114"><span class="id" title="binder">up_prevote</span></a> := <a class="idref" href="Grandpa.VoterState.html#update_prevoted"><span class="id" title="definition">VoterState.update_prevoted</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:111"><span class="id" title="variable">vs</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#b:112"><span class="id" title="variable">b</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="up_round:115" class="idref" href="#up_round:115"><span class="id" title="binder">up_round</span></a> := <a class="idref" href="Grandpa.VoterState.html#update_votes_with_msg"><span class="id" title="definition">VoterState.update_votes_with_msg</span></a> <a class="idref" href="Grandpa.Protocol.html#up_prevote:114"><span class="id" title="variable">up_prevote</span></a> <a class="idref" href="Grandpa.Protocol.html#new_message:113"><span class="id" title="variable">new_message</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#advance_count"><span class="id" title="definition">advance_count</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#update_voter_state"><span class="id" title="definition">update_voter_state</span></a> (<a class="idref" href="Grandpa.Protocol.html#update_message"><span class="id" title="definition">update_message</span></a> <a class="idref" href="Grandpa.Protocol.html#state:109"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#new_message:113"><span class="id" title="variable">new_message</span></a>) <a class="idref" href="Grandpa.Protocol.html#voter:110"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#up_round:115"><span class="id" title="variable">up_round</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="build_and_send_precommit" class="idref" href="#build_and_send_precommit"><span class="id" title="definition">build_and_send_precommit</span></a><br/>
&nbsp;&nbsp;(<a id="t:116" class="idref" href="#t:116"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="state:117" class="idref" href="#state:117"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:118" class="idref" href="#voter:118"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="vs:119" class="idref" href="#vs:119"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;(<a id="b:120" class="idref" href="#b:120"><span class="id" title="binder">b</span></a>:<a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="new_message:121" class="idref" href="#new_message:121"><span class="id" title="binder">new_message</span></a> : <a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message.Message</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>:= <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Grandpa.Protocol.html#state:117"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#block"><span class="id" title="projection">Message.block</span></a>:=<a class="idref" href="Grandpa.Protocol.html#b:120"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#kind"><span class="id" title="projection">kind</span></a>:=<a class="idref" href="Grandpa.Message.html#PreCommitMessage"><span class="id" title="constructor">Message.PreCommitMessage</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#round"><span class="id" title="projection">round</span></a>:=<a class="idref" href="Grandpa.Protocol.html#vs:119"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#time"><span class="id" title="projection">time</span></a>:=<a class="idref" href="Grandpa.Protocol.html#t:116"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#voter"><span class="id" title="projection">voter</span></a>:=<a class="idref" href="Grandpa.Protocol.html#voter:118"><span class="id" title="variable">voter</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#processed_by"><span class="id" title="projection">processed_by</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#from_list"><span class="id" title="definition">Dictionary.from_list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Protocol.html#voter:118"><span class="id" title="variable">voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Sets.html#UnitC"><span class="id" title="constructor">UnitC</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id="up_precommit:122" class="idref" href="#up_precommit:122"><span class="id" title="binder">up_precommit</span></a> := <a class="idref" href="Grandpa.VoterState.html#update_precommit"><span class="id" title="definition">VoterState.update_precommit</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:119"><span class="id" title="variable">vs</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#b:120"><span class="id" title="variable">b</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="up_round:123" class="idref" href="#up_round:123"><span class="id" title="binder">up_round</span></a> := <a class="idref" href="Grandpa.VoterState.html#update_votes_with_msg"><span class="id" title="definition">VoterState.update_votes_with_msg</span></a> <a class="idref" href="Grandpa.Protocol.html#up_precommit:122"><span class="id" title="variable">up_precommit</span></a> <a class="idref" href="Grandpa.Protocol.html#new_message:121"><span class="id" title="variable">new_message</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#advance_count"><span class="id" title="definition">advance_count</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#update_voter_state"><span class="id" title="definition">update_voter_state</span></a> (<a class="idref" href="Grandpa.Protocol.html#update_message"><span class="id" title="definition">update_message</span></a> <a class="idref" href="Grandpa.Protocol.html#state:117"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#new_message:121"><span class="id" title="variable">new_message</span></a>) <a class="idref" href="Grandpa.Protocol.html#voter:118"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#up_round:123"><span class="id" title="variable">up_round</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="build_and_send_primary_estimate" class="idref" href="#build_and_send_primary_estimate"><span class="id" title="definition">build_and_send_primary_estimate</span></a><br/>
&nbsp;&nbsp;(<a id="t:124" class="idref" href="#t:124"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="state:125" class="idref" href="#state:125"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:126" class="idref" href="#voter:126"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="vs:127" class="idref" href="#vs:127"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;(<a id="b:128" class="idref" href="#b:128"><span class="id" title="binder">b</span></a>:<a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="new_message:129" class="idref" href="#new_message:129"><span class="id" title="binder">new_message</span></a> : <a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message.Message</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>:= <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Grandpa.Protocol.html#state:125"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#block"><span class="id" title="projection">Message.block</span></a>:=<a class="idref" href="Grandpa.Protocol.html#b:128"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#kind"><span class="id" title="projection">kind</span></a>:=<a class="idref" href="Grandpa.Message.html#EstimateMessage"><span class="id" title="constructor">Message.EstimateMessage</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#round"><span class="id" title="projection">round</span></a>:=<a class="idref" href="Grandpa.Protocol.html#vs:127"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#time"><span class="id" title="projection">time</span></a>:=<a class="idref" href="Grandpa.Protocol.html#t:124"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#voter"><span class="id" title="projection">voter</span></a>:=<a class="idref" href="Grandpa.Protocol.html#voter:126"><span class="id" title="variable">voter</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#processed_by"><span class="id" title="projection">processed_by</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#from_list"><span class="id" title="definition">Dictionary.from_list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Protocol.html#voter:126"><span class="id" title="variable">voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Sets.html#UnitC"><span class="id" title="constructor">UnitC</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="updated_voter_state:130" class="idref" href="#updated_voter_state:130"><span class="id" title="binder">updated_voter_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.VoterState.html#update_last_block"><span class="id" title="definition">VoterState.update_last_block</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:127"><span class="id" title="variable">vs</span></a> <a class="idref" href="Grandpa.Protocol.html#b:128"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#advance_count"><span class="id" title="definition">advance_count</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#update_voter_state"><span class="id" title="definition">update_voter_state</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#update_message"><span class="id" title="definition">update_message</span></a> <a class="idref" href="Grandpa.Protocol.html#state:125"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#new_message:129"><span class="id" title="variable">new_message</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#voter:126"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#updated_voter_state:130"><span class="id" title="variable">updated_voter_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="build_and_send_finalized_block" class="idref" href="#build_and_send_finalized_block"><span class="id" title="definition">build_and_send_finalized_block</span></a><br/>
&nbsp;&nbsp;(<a id="t:131" class="idref" href="#t:131"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="state:132" class="idref" href="#state:132"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:133" class="idref" href="#voter:133"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="vs:134" class="idref" href="#vs:134"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;(<a id="b:135" class="idref" href="#b:135"><span class="id" title="binder">b</span></a>:<a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)<br/>
&nbsp;&nbsp;(<a id="votes:136" class="idref" href="#votes:136"><span class="id" title="binder">votes</span></a>:<a class="idref" href="Grandpa.Message.html#FinalizeBlock"><span class="id" title="record">Message.FinalizeBlock</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="new_message:137" class="idref" href="#new_message:137"><span class="id" title="binder">new_message</span></a> : <a class="idref" href="Grandpa.Message.html#Message"><span class="id" title="record">Message.Message</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Message.html#id"><span class="id" title="projection">id</span></a>:= <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Grandpa.Protocol.html#state:132"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#message_count"><span class="id" title="projection">message_count</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#block"><span class="id" title="projection">Message.block</span></a>:=<a class="idref" href="Grandpa.Protocol.html#b:135"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#kind"><span class="id" title="projection">kind</span></a>:=<a class="idref" href="Grandpa.Message.html#FinalizationMessage"><span class="id" title="constructor">Message.FinalizationMessage</span></a> <a class="idref" href="Grandpa.Protocol.html#votes:136"><span class="id" title="variable">votes</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#round"><span class="id" title="projection">round</span></a>:=<a class="idref" href="Grandpa.Protocol.html#vs:134"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#time"><span class="id" title="projection">time</span></a>:=<a class="idref" href="Grandpa.Protocol.html#t:131"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#voter"><span class="id" title="projection">voter</span></a>:=<a class="idref" href="Grandpa.Protocol.html#voter:133"><span class="id" title="variable">voter</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#processed_by"><span class="id" title="projection">processed_by</span></a>:=<a class="idref" href="Grandpa.Dictionary.html#from_list"><span class="id" title="definition">Dictionary.from_list</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Protocol.html#voter:133"><span class="id" title="variable">voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Sets.html#UnitC"><span class="id" title="constructor">UnitC</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="updated_voter_state:138" class="idref" href="#updated_voter_state:138"><span class="id" title="binder">updated_voter_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.VoterState.html#update_add_finalized_block"><span class="id" title="definition">VoterState.update_add_finalized_block</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:134"><span class="id" title="variable">vs</span></a> <a class="idref" href="Grandpa.Protocol.html#b:135"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#advance_count"><span class="id" title="definition">advance_count</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#update_voter_state"><span class="id" title="definition">update_voter_state</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#update_message"><span class="id" title="definition">update_message</span></a> <a class="idref" href="Grandpa.Protocol.html#state:132"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#new_message:137"><span class="id" title="variable">new_message</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#voter:133"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#updated_voter_state:138"><span class="id" title="variable">updated_voter_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prevoter_step_aux" class="idref" href="#prevoter_step_aux"><span class="id" title="definition">prevoter_step_aux</span></a> `{<a id="H:139" class="idref" href="#H:139"><span class="id" title="binder">Io</span></a>} (<a id="t:140" class="idref" href="#t:140"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="state:141" class="idref" href="#state:141"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="voter:142" class="idref" href="#voter:142"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="vs:143" class="idref" href="#vs:143"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tower:144" class="idref" href="#tower:144"><span class="id" title="binder">tower</span></a> := <a class="idref" href="Grandpa.Protocol.html#vs:143"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">VoterState.rounds</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Vectors.html#get"><span class="id" title="definition">Vectors.get</span></a> <a class="idref" href="Grandpa.Protocol.html#tower:144"><span class="id" title="variable">tower</span></a> (<a class="idref" href="Grandpa.Protocol.html#vs:143"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;|<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a> <span class="id" title="var">previous_round</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="ref_block:145" class="idref" href="#ref_block:145"><span class="id" title="binder">ref_block</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#vs:143"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#last_brodcasted_block"><span class="id" title="projection">last_brodcasted_block</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Preliminars.html#g"><span class="id" title="definition">g</span></a> (<a class="idref" href="Grandpa.Round.html#get_all_prevote_votes"><span class="id" title="definition">get_all_prevote_votes</span></a> <span class="id" title="var">previous_round</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Estimate.html#get_estimate"><span class="id" title="definition">get_estimate</span></a> <span class="id" title="var">previous_round</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">g_prev</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">estimate_prev</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Blocks.html#is_prefix"><span class="id" title="definition">is_prefix</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <span class="id" title="var">estimate_prev</span>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <span class="id" title="var">b</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="Grandpa.Blocks.html#is_prefix"><span class="id" title="definition">is_prefix</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <span class="id" title="var">b</span>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <span class="id" title="var">g_prev</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Grandpa.Estimate.html#get_estimate"><span class="id" title="definition">get_estimate</span></a> <span class="id" title="var">previous_round</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="Grandpa.Estimate.html#get_estimate"><span class="id" title="definition">get_estimate</span></a> <span class="id" title="var">previous_round</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Estimate.html#get_estimate"><span class="id" title="definition">get_estimate</span></a> <span class="id" title="var">previous_round</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Functors.html#map"><span class="id" title="method">map</span></a> (<a class="idref" href="Grandpa.Protocol.html#look_for_best_chain_for_block"><span class="id" title="definition">look_for_best_chain_for_block</span></a> <a class="idref" href="Grandpa.Protocol.html#t:140"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:142"><span class="id" title="variable">voter</span></a>) <a class="idref" href="Grandpa.Protocol.html#ref_block:145"><span class="id" title="variable">ref_block</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#build_and_send_prevote"><span class="id" title="definition">build_and_send_prevote</span></a> <a class="idref" href="Grandpa.Protocol.html#t:140"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:141"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:142"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:143"><span class="id" title="variable">vs</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:141"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:141"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prevoter_step_legit" class="idref" href="#prevoter_step_legit"><span class="id" title="definition">prevoter_step_legit</span></a> `{<a id="H:146" class="idref" href="#H:146"><span class="id" title="binder">Io</span></a>} <br/>
&nbsp;&nbsp;(<a id="t:147" class="idref" href="#t:147"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) <br/>
&nbsp;&nbsp;(<a id="state:148" class="idref" href="#state:148"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:149" class="idref" href="#voter:149"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="category:150" class="idref" href="#category:150"><span class="id" title="binder">category</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterCategory"><span class="id" title="inductive">VoterCategory</span></a>)<br/>
&nbsp;&nbsp;(<a id="vs:151" class="idref" href="#vs:151"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#vs:151"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#prevoted_block"><span class="id" title="projection">prevoted_block</span></a>) <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:148"><span class="id" title="variable">state</span></a> <br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tower:152" class="idref" href="#tower:152"><span class="id" title="binder">tower</span></a> := <a class="idref" href="Grandpa.Protocol.html#vs:151"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">VoterState.rounds</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Vectors.html#get"><span class="id" title="definition">Vectors.get</span></a> <a class="idref" href="Grandpa.Protocol.html#tower:152"><span class="id" title="variable">tower</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:151"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a> <span class="id" title="var">round_</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Estimate.html#try_to_complete_round"><span class="id" title="axiom">try_to_complete_round</span></a> <span class="id" title="var">round_</span>  <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#prevoter_step_aux"><span class="id" title="definition">prevoter_step_aux</span></a> <a class="idref" href="Grandpa.Protocol.html#t:147"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:148"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:149"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:151"><span class="id" title="variable">vs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Grandpa.Protocol.html#t:147"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0f31f5c1c6b6a21a3a187247222bc9e4"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="Grandpa.Round.html#get_start_time"><span class="id" title="definition">Round.get_start_time</span></a> <span class="id" title="var">round_</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 2<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">×</span></a><a class="idref" href="Grandpa.Protocol.html#global_time_constant"><span class="id" title="method">global_time_constant</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#prevoter_step_aux"><span class="id" title="definition">prevoter_step_aux</span></a> <a class="idref" href="Grandpa.Protocol.html#t:147"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:148"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:149"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:151"><span class="id" title="variable">vs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#state:148"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:148"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="prevoter_step" class="idref" href="#prevoter_step"><span class="id" title="definition">prevoter_step</span></a> `{<a id="H:153" class="idref" href="#H:153"><span class="id" title="binder">Io</span></a>} <br/>
&nbsp;&nbsp;(<a id="t:154" class="idref" href="#t:154"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) <br/>
&nbsp;&nbsp;(<a id="state:155" class="idref" href="#state:155"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:156" class="idref" href="#voter:156"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="category:157" class="idref" href="#category:157"><span class="id" title="binder">category</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterCategory"><span class="id" title="inductive">VoterCategory</span></a>)<br/>
&nbsp;&nbsp;(<a id="vs:158" class="idref" href="#vs:158"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#category:157"><span class="id" title="variable">category</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">VoterState.Bizantine</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#io_bizantine_vote"><span class="id" title="method">io_bizantine_vote</span></a> <a class="idref" href="Grandpa.Protocol.html#t:154"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:156"><span class="id" title="variable">voter</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#build_and_send_prevote"><span class="id" title="definition">build_and_send_prevote</span></a> <a class="idref" href="Grandpa.Protocol.html#t:154"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:155"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:156"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:158"><span class="id" title="variable">vs</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:155"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#Honest"><span class="id" title="constructor">VoterState.Honest</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#prevoter_step_legit"><span class="id" title="definition">prevoter_step_legit</span></a> <a class="idref" href="Grandpa.Protocol.html#t:154"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:155"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:156"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#category:157"><span class="id" title="variable">category</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:158"><span class="id" title="variable">vs</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="precommit_step_legit" class="idref" href="#precommit_step_legit"><span class="id" title="definition">precommit_step_legit</span></a> `{<a id="H:160" class="idref" href="#H:160"><span class="id" title="binder">Io</span></a>} <br/>
&nbsp;&nbsp;(<a id="t:161" class="idref" href="#t:161"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) <br/>
&nbsp;&nbsp;(<a id="state:162" class="idref" href="#state:162"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:163" class="idref" href="#voter:163"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="category:164" class="idref" href="#category:164"><span class="id" title="binder">category</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterCategory"><span class="id" title="inductive">VoterCategory</span></a>)<br/>
&nbsp;&nbsp;(<a id="vs:165" class="idref" href="#vs:165"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tower:166" class="idref" href="#tower:166"><span class="id" title="binder">tower</span></a> := <a class="idref" href="Grandpa.Protocol.html#vs:165"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">VoterState.rounds</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#vs:165"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#precommited_block"><span class="id" title="projection">precommited_block</span></a>) <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:162"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Vectors.html#get"><span class="id" title="definition">Vectors.get</span></a> <a class="idref" href="Grandpa.Protocol.html#tower:166"><span class="id" title="variable">tower</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:165"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a> <span class="id" title="var">r</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Vectors.html#get"><span class="id" title="definition">Vectors.get</span></a> <a class="idref" href="Grandpa.Protocol.html#tower:166"><span class="id" title="variable">tower</span></a> (<a class="idref" href="Grandpa.Protocol.html#vs:165"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a> <span class="id" title="var">r_prev</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Preliminars.html#g"><span class="id" title="definition">g</span></a> (<a class="idref" href="Grandpa.Round.html#get_all_prevote_votes"><span class="id" title="definition">get_all_prevote_votes</span></a> <span class="id" title="var">r</span>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Grandpa.Estimate.html#get_estimate"><span class="id" title="definition">get_estimate</span></a> <span class="id" title="var">r_prev</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">g_r</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">estimate_prev</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Protocol.html#t:161"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="Grandpa.Round.html#get_start_time"><span class="id" title="definition">get_start_time</span></a> <span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 4<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#ea2ff3d561159081cea6fb2e8113cc54"><span class="id" title="notation">×</span></a><a class="idref" href="Grandpa.Protocol.html#global_time_constant"><span class="id" title="method">global_time_constant</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="Grandpa.Estimate.html#is_completable"><span class="id" title="definition">Estimate.is_completable</span></a> <span class="id" title="var">r</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#build_and_send_precommit"><span class="id" title="definition">build_and_send_precommit</span></a> <a class="idref" href="Grandpa.Protocol.html#t:161"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:162"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:163"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:165"><span class="id" title="variable">vs</span></a> <span class="id" title="var">g_r</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#state:162"><span class="id" title="variable">state</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:162"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:162"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:162"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="precommit_step" class="idref" href="#precommit_step"><span class="id" title="definition">precommit_step</span></a> `{<a id="H:167" class="idref" href="#H:167"><span class="id" title="binder">Io</span></a>} <br/>
&nbsp;&nbsp;(<a id="t:168" class="idref" href="#t:168"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) <br/>
&nbsp;&nbsp;(<a id="state:169" class="idref" href="#state:169"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:170" class="idref" href="#voter:170"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="category:171" class="idref" href="#category:171"><span class="id" title="binder">category</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterCategory"><span class="id" title="inductive">VoterCategory</span></a>)<br/>
&nbsp;&nbsp;(<a id="vs:172" class="idref" href="#vs:172"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#category:171"><span class="id" title="variable">category</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">VoterState.Bizantine</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#io_bizantine_vote"><span class="id" title="method">io_bizantine_vote</span></a> <a class="idref" href="Grandpa.Protocol.html#t:168"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:170"><span class="id" title="variable">voter</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#build_and_send_precommit"><span class="id" title="definition">build_and_send_precommit</span></a> <a class="idref" href="Grandpa.Protocol.html#t:168"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:169"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:170"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:172"><span class="id" title="variable">vs</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:169"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#Honest"><span class="id" title="constructor">VoterState.Honest</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#precommit_step_legit"><span class="id" title="definition">precommit_step_legit</span></a> <a class="idref" href="Grandpa.Protocol.html#t:168"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:169"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:170"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#category:171"><span class="id" title="variable">category</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:172"><span class="id" title="variable">vs</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_last_finalized_block_number" class="idref" href="#get_last_finalized_block_number"><span class="id" title="definition">get_last_finalized_block_number</span></a><br/>
&nbsp;&nbsp;(<a id="finalized_blocks:174" class="idref" href="#finalized_blocks:174"><span class="id" title="binder">finalized_blocks</span></a>:<a class="idref" href="Grandpa.Sets.html#DictionarySet"><span class="id" title="inductive">Sets.DictionarySet</span></a> <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)  <br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="acc:175" class="idref" href="#acc:175"><span class="id" title="binder">acc</span></a> <a id="y:176" class="idref" href="#y:176"><span class="id" title="binder">y</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#max"><span class="id" title="definition">max</span></a> <a class="idref" href="Grandpa.Protocol.html#acc:175"><span class="id" title="variable">acc</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT1"><span class="id" title="definition">projT1</span></a> <a class="idref" href="Grandpa.Protocol.html#y:176"><span class="id" title="variable">y</span></a>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Sets.html#to_list"><span class="id" title="definition">Sets.to_list</span></a> <a class="idref" href="Grandpa.Protocol.html#finalized_blocks:174"><span class="id" title="variable">finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="should_finalize" class="idref" href="#should_finalize"><span class="id" title="definition">should_finalize</span></a><br/>
&nbsp;&nbsp;(<a id="finalized_blocks:177" class="idref" href="#finalized_blocks:177"><span class="id" title="binder">finalized_blocks</span></a>:<a class="idref" href="Grandpa.Sets.html#DictionarySet"><span class="id" title="inductive">Sets.DictionarySet</span></a> <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)  <br/>
&nbsp;&nbsp;(<a id="opaque:178" class="idref" href="#opaque:178"><span class="id" title="binder">opaque</span></a>:<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a>) <br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="max_block_number:179" class="idref" href="#max_block_number:179"><span class="id" title="binder">max_block_number</span></a> := <a class="idref" href="Grandpa.Protocol.html#get_last_finalized_block_number"><span class="id" title="definition">get_last_finalized_block_number</span></a> <a class="idref" href="Grandpa.Protocol.html#finalized_blocks:177"><span class="id" title="variable">finalized_blocks</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#opaque:178"><span class="id" title="variable">opaque</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a> <span class="id" title="var">r</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Preliminars.html#g"><span class="id" title="definition">g</span></a> (<a class="idref" href="Grandpa.Round.html#get_all_precommit_votes"><span class="id" title="definition">Round.get_all_precommit_votes</span></a> <span class="id" title="var">r</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Sets.html#or"><span class="id" title="definition">Sets.or</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="b2:181" class="idref" href="#b2:181"><span class="id" title="binder">b2</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT1"><span class="id" title="definition">projT1</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="Grandpa.Protocol.html#max_block_number:179"><span class="id" title="variable">max_block_number</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Blocks.html#is_prefix"><span class="id" title="definition">is_prefix</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <span class="id" title="var">b</span>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <a class="idref" href="Grandpa.Protocol.html#b2:181"><span class="id" title="variable">b2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#finalized_blocks:177"><span class="id" title="variable">finalized_blocks</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_some" class="idref" href="#is_some"><span class="id" title="definition">is_some</span></a> {<a id="A:182" class="idref" href="#A:182"><span class="id" title="binder">A</span></a>} (<a id="o:183" class="idref" href="#o:183"><span class="id" title="binder">o</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Grandpa.Protocol.html#A:182"><span class="id" title="variable">A</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#o:183"><span class="id" title="variable">o</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_voter_kind_for_round" class="idref" href="#get_voter_kind_for_round"><span class="id" title="definition">get_voter_kind_for_round</span></a> `{<a id="H:185" class="idref" href="#H:185"><span class="id" title="binder">Io</span></a>} (<a id="v:186" class="idref" href="#v:186"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="round_number:187" class="idref" href="#round_number:187"><span class="id" title="binder">round_number</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterKind"><span class="id" title="inductive">VoterKind</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a>  <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#v:186"><span class="id" title="variable">v</span></a> (<a class="idref" href="Grandpa.Protocol.html#io_get_round_voters"><span class="id" title="method">io_get_round_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:187"><span class="id" title="variable">round_number</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_voter_state" class="idref" href="#get_voter_state"><span class="id" title="definition">get_voter_state</span></a> (<a id="v:188" class="idref" href="#v:188"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="state:189" class="idref" href="#state:189"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a>  <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#v:188"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#state:189"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>) .<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="is_voter_for_round" class="idref" href="#is_voter_for_round"><span class="id" title="definition">is_voter_for_round</span></a> `{<a id="H:190" class="idref" href="#H:190"><span class="id" title="binder">Io</span></a>} (<a id="v:191" class="idref" href="#v:191"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="round_number:192" class="idref" href="#round_number:192"><span class="id" title="binder">round_number</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#is_some"><span class="id" title="definition">is_some</span></a> (<a class="idref" href="Grandpa.Protocol.html#get_voter_kind_for_round"><span class="id" title="definition">get_voter_kind_for_round</span></a> <a class="idref" href="Grandpa.Protocol.html#v:191"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#round_number:192"><span class="id" title="variable">round_number</span></a>).<br/>

<br/>
<span class="id" title="keyword">Program Definition</span> <a id="get_blocks_to_finalize" class="idref" href="#get_blocks_to_finalize"><span class="id" title="definition">get_blocks_to_finalize</span></a> `{<a id="H:193" class="idref" href="#H:193"><span class="id" title="binder">Io</span></a>} (<a id="voter:194" class="idref" href="#voter:194"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="vs:195" class="idref" href="#vs:195"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>) <br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)<br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="finalizeds:196" class="idref" href="#finalizeds:196"><span class="id" title="binder">finalizeds</span></a> := <a class="idref" href="Grandpa.Protocol.html#vs:195"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#finalized_blocks"><span class="id" title="projection">VoterState.finalized_blocks</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="all_previous_rounds:197" class="idref" href="#all_previous_rounds:197"><span class="id" title="binder">all_previous_rounds</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Vectors.VectorDef.html#to_list"><span class="id" title="definition">VectorDef.to_list</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Vectors.VectorDef.html#take"><span class="id" title="definition">VectorDef.take</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#vs:195"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#vs:195"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">VoterState.rounds</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="predicate:199" class="idref" href="#predicate:199"><span class="id" title="binder">predicate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:=<span class="id" title="keyword">fun</span> <a id="opaque:198" class="idref" href="#opaque:198"><span class="id" title="binder">opaque</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#is_voter_for_round"><span class="id" title="definition">is_voter_for_round</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:194"><span class="id" title="variable">voter</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#get_round_number"><span class="id" title="definition">OpaqueRound.get_round_number</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque:198"><span class="id" title="variable">opaque</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="filtered_rounds:200" class="idref" href="#filtered_rounds:200"><span class="id" title="binder">filtered_rounds</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#filter"><span class="id" title="definition">List.filter</span></a> <a class="idref" href="Grandpa.Protocol.html#predicate:199"><span class="id" title="variable">predicate</span></a> <a class="idref" href="Grandpa.Protocol.html#all_previous_rounds:197"><span class="id" title="variable">all_previous_rounds</span></a><br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="acc:201" class="idref" href="#acc:201"><span class="id" title="binder">acc</span></a> <a id="opaque:202" class="idref" href="#opaque:202"><span class="id" title="binder">opaque</span></a> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#should_finalize"><span class="id" title="definition">should_finalize</span></a> <a class="idref" href="Grandpa.Protocol.html#finalizeds:196"><span class="id" title="variable">finalizeds</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque:202"><span class="id" title="variable">opaque</span></a>  <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Protocol.html#opaque:202"><span class="id" title="variable">opaque</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="Grandpa.Protocol.html#acc:201"><span class="id" title="variable">acc</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#acc:201"><span class="id" title="variable">acc</span></a> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#filtered_rounds:200"><span class="id" title="variable">filtered_rounds</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#nil"><span class="id" title="abbreviation">List.nil</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="finalize_block" class="idref" href="#finalize_block"><span class="id" title="definition">finalize_block</span></a> (<a id="t:203" class="idref" href="#t:203"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:204" class="idref" href="#voter:204"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="state:205" class="idref" href="#state:205"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="opaque_and_block:206" class="idref" href="#opaque_and_block:206"><span class="id" title="binder">opaque_and_block</span></a>:<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">×</span></a> <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#get_voter_state"><span class="id" title="definition">get_voter_state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:204"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#state:205"><span class="id" title="variable">state</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">vs</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<a id="opaque:207" class="idref" href="#opaque:207"><span class="id" title="binder">opaque</span></a>,<a id="b:208" class="idref" href="#b:208"><span class="id" title="binder">b</span></a>) := <a class="idref" href="Grandpa.Protocol.html#opaque_and_block:206"><span class="id" title="variable">opaque_and_block</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="fin_msg:209" class="idref" href="#fin_msg:209"><span class="id" title="binder">fin_msg</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:<a class="idref" href="Grandpa.Message.html#FinalizeBlock"><span class="id" title="record">Message.FinalizeBlock</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:={|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Message.html#prevoters"><span class="id" title="projection">prevoters</span></a>:= <a class="idref" href="Grandpa.OpaqueRound.html#get_prevote_voters"><span class="id" title="definition">OpaqueRound.get_prevote_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque:207"><span class="id" title="variable">opaque</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#precommiters"><span class="id" title="projection">precommiters</span></a>:= <a class="idref" href="Grandpa.OpaqueRound.html#get_precommit_voters"><span class="id" title="definition">OpaqueRound.get_precommit_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque:207"><span class="id" title="variable">opaque</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#prevotes"><span class="id" title="projection">prevotes</span></a>:= <a class="idref" href="Grandpa.OpaqueRound.html#get_all_prevote_votes"><span class="id" title="definition">OpaqueRound.get_all_prevote_votes</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque:207"><span class="id" title="variable">opaque</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<a class="idref" href="Grandpa.Message.html#precommits"><span class="id" title="projection">precommits</span></a>:= <a class="idref" href="Grandpa.OpaqueRound.html#get_all_precommit_votes"><span class="id" title="definition">OpaqueRound.get_all_precommit_votes</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque:207"><span class="id" title="variable">opaque</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#build_and_send_finalized_block"><span class="id" title="definition">build_and_send_finalized_block</span></a> <a class="idref" href="Grandpa.Protocol.html#t:203"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:205"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:204"><span class="id" title="variable">voter</span></a> <span class="id" title="var">vs</span> <a class="idref" href="Grandpa.Protocol.html#b:208"><span class="id" title="variable">b</span></a> <a class="idref" href="Grandpa.Protocol.html#fin_msg:209"><span class="id" title="variable">fin_msg</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:205"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="finalization" class="idref" href="#finalization"><span class="id" title="definition">finalization</span></a> `{<a id="H:210" class="idref" href="#H:210"><span class="id" title="binder">Io</span></a>} (<a id="t:211" class="idref" href="#t:211"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="state:212" class="idref" href="#state:212"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:213" class="idref" href="#voter:213"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="vs:214" class="idref" href="#vs:214"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>) <br/>
&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> <br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#finalize_block"><span class="id" title="definition">finalize_block</span></a> <a class="idref" href="Grandpa.Protocol.html#t:211"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:213"><span class="id" title="variable">voter</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#get_blocks_to_finalize"><span class="id" title="definition">get_blocks_to_finalize</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:213"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:214"><span class="id" title="variable">vs</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#state:212"><span class="id" title="variable">state</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="wait_step_for_new_round" class="idref" href="#wait_step_for_new_round"><span class="id" title="definition">wait_step_for_new_round</span></a> `{<a id="H:215" class="idref" href="#H:215"><span class="id" title="binder">Io</span></a>}<br/>
&nbsp;&nbsp;(<a id="t:216" class="idref" href="#t:216"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:217" class="idref" href="#voter:217"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <br/>
&nbsp;&nbsp;(<a id="vs:218" class="idref" href="#vs:218"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;(<a id="state:219" class="idref" href="#state:219"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="tower:220" class="idref" href="#tower:220"><span class="id" title="binder">tower</span></a> := <a class="idref" href="Grandpa.Protocol.html#vs:218"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">VoterState.rounds</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Vectors.html#get"><span class="id" title="definition">Vectors.get</span></a> <a class="idref" href="Grandpa.Protocol.html#tower:220"><span class="id" title="variable">tower</span></a> (<a class="idref" href="Grandpa.Protocol.html#vs:218"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;|<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Estimate.html#try_to_complete_round"><span class="id" title="axiom">try_to_complete_round</span></a> <span class="id" title="var">r</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="new_vs:221" class="idref" href="#new_vs:221"><span class="id" title="binder">new_vs</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#init_next_round_voter_state"><span class="id" title="definition">init_next_round_voter_state</span></a> <a class="idref" href="Grandpa.Protocol.html#t:216"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:218"><span class="id" title="variable">vs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="updated_state:222" class="idref" href="#updated_state:222"><span class="id" title="binder">updated_state</span></a> := <a class="idref" href="Grandpa.Protocol.html#update_voter_state"><span class="id" title="definition">update_voter_state</span></a> <a class="idref" href="Grandpa.Protocol.html#state:219"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:217"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#new_vs:221"><span class="id" title="variable">new_vs</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Grandpa.Protocol.html#voter_is_primary_for_round"><span class="id" title="definition">voter_is_primary_for_round</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:217"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:218"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Estimate.html#get_estimate"><span class="id" title="definition">get_estimate</span></a> <span class="id" title="var">r</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">b</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#build_and_send_primary_estimate"><span class="id" title="definition">build_and_send_primary_estimate</span></a> <a class="idref" href="Grandpa.Protocol.html#t:216"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:219"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:217"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:218"><span class="id" title="variable">vs</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#updated_state:222"><span class="id" title="variable">updated_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#updated_state:222"><span class="id" title="variable">updated_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:219"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:219"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="should_wait_for_next_round" class="idref" href="#should_wait_for_next_round"><span class="id" title="definition">should_wait_for_next_round</span></a> `{<a id="H:223" class="idref" href="#H:223"><span class="id" title="binder">Io</span></a>} <br/>
&nbsp;&nbsp;(<a id="t:224" class="idref" href="#t:224"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) <br/>
&nbsp;&nbsp;(<a id="state:225" class="idref" href="#state:225"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) <br/>
&nbsp;&nbsp;(<a id="voter:226" class="idref" href="#voter:226"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>)<br/>
&nbsp;&nbsp;(<a id="vs:227" class="idref" href="#vs:227"><span class="id" title="binder">vs</span></a>:<a class="idref" href="Grandpa.VoterState.html#VoterState"><span class="id" title="record">VoterState</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#get_voter_kind_for_round"><span class="id" title="definition">get_voter_kind_for_round</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:226"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:227"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <a class="idref" href="Grandpa.VoterState.html#Bizantine"><span class="id" title="constructor">Bizantine</span></a> <span class="id" title="var">_</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#io_bizantine_advance_round"><span class="id" title="method">io_bizantine_advance_round</span></a> <a class="idref" href="Grandpa.Protocol.html#t:224"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:226"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:227"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <span class="id" title="var">_</span> <span class="id" title="var">vote_right</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">vote_right</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VotePrevote"><span class="id" title="constructor">VotePrevote</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="Grandpa.Protocol.html#is_some"><span class="id" title="definition">is_some</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:227"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#prevoted_block"><span class="id" title="projection">VoterState.prevoted_block</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VotePrecommit"><span class="id" title="constructor">VotePrecommit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="Grandpa.Protocol.html#is_some"><span class="id" title="definition">is_some</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:227"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#precommited_block"><span class="id" title="projection">VoterState.precommited_block</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoteBoth"><span class="id" title="constructor">VoteBoth</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <a class="idref" href="Grandpa.Protocol.html#is_some"><span class="id" title="definition">is_some</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:227"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#prevoted_block"><span class="id" title="projection">VoterState.prevoted_block</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#is_some"><span class="id" title="definition">is_some</span></a> <a class="idref" href="Grandpa.Protocol.html#vs:227"><span class="id" title="variable">vs</span></a>.(<a class="idref" href="Grandpa.VoterState.html#precommited_block"><span class="id" title="projection">VoterState.precommited_block</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="voter_round_step_aux" class="idref" href="#voter_round_step_aux"><span class="id" title="definition">voter_round_step_aux</span></a> `{<a id="H:229" class="idref" href="#H:229"><span class="id" title="binder">Io</span></a>} (<a id="t:230" class="idref" href="#t:230"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="state:231" class="idref" href="#state:231"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="voter:232" class="idref" href="#voter:232"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>): <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#get_voter_state"><span class="id" title="definition">get_voter_state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:232"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">voter_state_</span> ⇒  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Grandpa.Protocol.html#should_wait_for_next_round"><span class="id" title="definition">should_wait_for_next_round</span></a> <a class="idref" href="Grandpa.Protocol.html#t:230"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:232"><span class="id" title="variable">voter</span></a> <span class="id" title="var">voter_state_</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="Grandpa.Protocol.html#wait_step_for_new_round"><span class="id" title="definition">wait_step_for_new_round</span></a> <a class="idref" href="Grandpa.Protocol.html#t:230"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:232"><span class="id" title="variable">voter</span></a> <span class="id" title="var">voter_state_</span> <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#get_voter_kind_for_round"><span class="id" title="definition">get_voter_kind_for_round</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:232"><span class="id" title="variable">voter</span></a> <span class="id" title="var">voter_state_</span>.(<a class="idref" href="Grandpa.VoterState.html#round_number"><span class="id" title="projection">VoterState.round_number</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a>(<a class="idref" href="Grandpa.VoterState.html#VoterKindC"><span class="id" title="constructor">VoterKindC</span></a> <span class="id" title="var">category</span> <span class="id" title="var">kind_</span>) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">kind_</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VotePrevote"><span class="id" title="constructor">VotePrevote</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#prevoter_step"><span class="id" title="definition">prevoter_step</span></a> <a class="idref" href="Grandpa.Protocol.html#t:230"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:232"><span class="id" title="variable">voter</span></a> <span class="id" title="var">category</span> <span class="id" title="var">voter_state_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VotePrecommit"><span class="id" title="constructor">VotePrecommit</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;⇒  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#precommit_step"><span class="id" title="definition">precommit_step</span></a> <a class="idref" href="Grandpa.Protocol.html#t:230"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:232"><span class="id" title="variable">voter</span></a> <span class="id" title="var">category</span> <span class="id" title="var">voter_state_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.VoterState.html#VoteBoth"><span class="id" title="constructor">VoteBoth</span></a> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">voter_state_</span>.(<a class="idref" href="Grandpa.VoterState.html#prevoted_block"><span class="id" title="projection">VoterState.prevoted_block</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">voter_state_</span>.(<a class="idref" href="Grandpa.VoterState.html#precommited_block"><span class="id" title="projection">VoterState.precommited_block</span></a>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#precommit_step"><span class="id" title="definition">precommit_step</span></a> <a class="idref" href="Grandpa.Protocol.html#t:230"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:232"><span class="id" title="variable">voter</span></a> <span class="id" title="var">category</span> <span class="id" title="var">voter_state_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#prevoter_step"><span class="id" title="definition">prevoter_step</span></a> <a class="idref" href="Grandpa.Protocol.html#t:230"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:232"><span class="id" title="variable">voter</span></a> <span class="id" title="var">category</span> <span class="id" title="var">voter_state_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:231"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="voter_round_step" class="idref" href="#voter_round_step"><span class="id" title="definition">voter_round_step</span></a> `{<a id="H:234" class="idref" href="#H:234"><span class="id" title="binder">Io</span></a>} (<a id="t:235" class="idref" href="#t:235"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="state:236" class="idref" href="#state:236"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="voter:237" class="idref" href="#voter:237"><span class="id" title="binder">voter</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>): <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:237"><span class="id" title="variable">voter</span></a> <a class="idref" href="Grandpa.Protocol.html#state:236"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>)<span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">vs</span> ⇒  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#voter_round_step_aux"><span class="id" title="definition">voter_round_step_aux</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#t:235"><span class="id" title="variable">t</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#finalization"><span class="id" title="definition">finalization</span></a> <a class="idref" href="Grandpa.Protocol.html#t:235"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:236"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#voter:237"><span class="id" title="variable">voter</span></a> <span class="id" title="var">vs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#voter:237"><span class="id" title="variable">voter</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="Grandpa.Protocol.html#state:236"><span class="id" title="variable">state</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="voters_round_step" class="idref" href="#voters_round_step"><span class="id" title="definition">voters_round_step</span></a> `{<a id="H:238" class="idref" href="#H:238"><span class="id" title="binder">Io</span></a>} (<a id="t:239" class="idref" href="#t:239"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="state:240" class="idref" href="#state:240"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>): <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="voters:241" class="idref" href="#voters:241"><span class="id" title="binder">voters</span></a> := <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="Grandpa.Dictionary.html#to_list"><span class="id" title="definition">Dictionary.to_list</span></a> <a class="idref" href="Grandpa.Protocol.html#state:240"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#fold_left"><span class="id" title="definition">List.fold_left</span></a> (<a class="idref" href="Grandpa.Protocol.html#voter_round_step"><span class="id" title="definition">voter_round_step</span></a> <a class="idref" href="Grandpa.Protocol.html#t:239"><span class="id" title="variable">t</span></a>) <a class="idref" href="Grandpa.Protocol.html#voters:241"><span class="id" title="variable">voters</span></a> <a class="idref" href="Grandpa.Protocol.html#state:240"><span class="id" title="variable">state</span></a> .<br/>

<br/>
<span class="id" title="keyword">CoInductive</span> <a id="CoList" class="idref" href="#CoList"><span class="id" title="inductive">CoList</span></a> (<a id="T:242" class="idref" href="#T:242"><span class="id" title="binder">T</span></a>:<span class="id" title="keyword">Type</span>) :<span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a id="CoCons" class="idref" href="#CoCons"><span class="id" title="constructor">CoCons</span></a> : <a class="idref" href="Grandpa.Protocol.html#T:242"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Protocol.html#CoList:243"><span class="id" title="inductive">CoList</span></a> <a class="idref" href="Grandpa.Protocol.html#T:242"><span class="id" title="variable">T</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Protocol.html#CoList:243"><span class="id" title="inductive">CoList</span></a> <a class="idref" href="Grandpa.Protocol.html#T:242"><span class="id" title="variable">T</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a id="get_last" class="idref" href="#get_last"><span class="id" title="definition">get_last</span></a> {<a id="T:245" class="idref" href="#T:245"><span class="id" title="binder">T</span></a>} (<a id="n:246" class="idref" href="#n:246"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="colist:247" class="idref" href="#colist:247"><span class="id" title="binder">colist</span></a>:<a class="idref" href="Grandpa.Protocol.html#CoList"><span class="id" title="inductive">CoList</span></a> <a class="idref" href="Grandpa.Protocol.html#T:245"><span class="id" title="variable">T</span></a>): <a class="idref" href="Grandpa.Protocol.html#T:245"><span class="id" title="variable">T</span></a><br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#n:246"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;| 0 ⇒ <span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#colist:247"><span class="id" title="variable">colist</span></a>  <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.Protocol.html#CoCons"><span class="id" title="constructor">CoCons</span></a> <span class="id" title="var">_</span> <span class="id" title="var">element</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">element</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m</span> ⇒ <span class="id" title="keyword">match</span> <a class="idref" href="Grandpa.Protocol.html#colist:247"><span class="id" title="variable">colist</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Grandpa.Protocol.html#CoCons"><span class="id" title="constructor">CoCons</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">remain</span> ⇒ <a class="idref" href="Grandpa.Protocol.html#get_last:248"><span class="id" title="definition">get_last</span></a> <span class="id" title="var">m</span> <span class="id" title="var">remain</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">CoFixpoint</span> <a id="produce_states" class="idref" href="#produce_states"><span class="id" title="definition">produce_states</span></a> `{<a id="H:252" class="idref" href="#H:252"><span class="id" title="binder">Io</span></a>} (<a id="t:253" class="idref" href="#t:253"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>) (<a id="state:254" class="idref" href="#state:254"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>): <a class="idref" href="Grandpa.Protocol.html#CoList"><span class="id" title="inductive">CoList</span></a> <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="new_state:256" class="idref" href="#new_state:256"><span class="id" title="binder">new_state</span></a> := <a class="idref" href="Grandpa.Protocol.html#voters_round_step"><span class="id" title="definition">voters_round_step</span></a> <a class="idref" href="Grandpa.Protocol.html#t:253"><span class="id" title="variable">t</span></a> (<a class="idref" href="Grandpa.Protocol.html#update_votes"><span class="id" title="definition">update_votes</span></a> <a class="idref" href="Grandpa.Protocol.html#t:253"><span class="id" title="variable">t</span></a> <a class="idref" href="Grandpa.Protocol.html#state:254"><span class="id" title="variable">state</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#CoCons"><span class="id" title="constructor">CoCons</span></a> <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> <a class="idref" href="Grandpa.Protocol.html#new_state:256"><span class="id" title="variable">new_state</span></a>  (<a class="idref" href="Grandpa.Protocol.html#produce_states:255"><span class="id" title="definition">produce_states</span></a> (<a class="idref" href="Grandpa.Protocol.html#t:253"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1) <a class="idref" href="Grandpa.Protocol.html#new_state:256"><span class="id" title="variable">new_state</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_state_up_to" class="idref" href="#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> `{<a id="H:257" class="idref" href="#H:257"><span class="id" title="binder">Io</span></a>} (<a id="t:258" class="idref" href="#t:258"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>): <a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a> :=   <br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#get_last"><span class="id" title="definition">get_last</span></a> <a class="idref" href="Grandpa.Protocol.html#t:258"><span class="id" title="variable">t</span></a> (<a class="idref" href="Grandpa.Protocol.html#produce_states"><span class="id" title="definition">produce_states</span></a> 0 <a class="idref" href="Grandpa.Protocol.html#make_initial_state"><span class="id" title="definition">make_initial_state</span></a>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="get_global_finalized_blocks_are_related" class="idref" href="#get_global_finalized_blocks_are_related"><span class="id" title="lemma">get_global_finalized_blocks_are_related</span></a> (<a id="state:259" class="idref" href="#state:259"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;(<a id="b1:260" class="idref" href="#b1:260"><span class="id" title="binder">b1</span></a> <a id="b2:261" class="idref" href="#b2:261"><span class="id" title="binder">b2</span></a> : <a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>) <br/>
&nbsp;&nbsp;(<a id="b1_in:263" class="idref" href="#b1_in:263"><span class="id" title="binder">b1_in</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">List.In</span></a> <a class="idref" href="Grandpa.Protocol.html#b1:260"><span class="id" title="variable">b1</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> ( <span class="id" title="keyword">fun</span> <a id="x:262" class="idref" href="#x:262"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Grandpa.Protocol.html#x:262"><span class="id" title="variable">x</span></a>)) <a class="idref" href="Grandpa.Protocol.html#state:259"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)))<br/>
&nbsp;&nbsp;(<a id="b2_in:265" class="idref" href="#b2_in:265"><span class="id" title="binder">b2_in</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">List.In</span></a> <a class="idref" href="Grandpa.Protocol.html#b2:261"><span class="id" title="variable">b2</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> ( <span class="id" title="keyword">fun</span> <a id="x:264" class="idref" href="#x:264"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Grandpa.Protocol.html#x:264"><span class="id" title="variable">x</span></a>)) <a class="idref" href="Grandpa.Protocol.html#state:259"><span class="id" title="variable">state</span></a>.(<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a>)))<br/>
&nbsp;&nbsp;: <a class="idref" href="Grandpa.Blocks.html#Related"><span class="id" title="inductive">Related</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <a class="idref" href="Grandpa.Protocol.html#b1:260"><span class="id" title="variable">b1</span></a>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <a class="idref" href="Grandpa.Protocol.html#b2:261"><span class="id" title="variable">b2</span></a>).<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="ProtocolConsistency" class="idref" href="#ProtocolConsistency"><span class="id" title="section">ProtocolConsistency</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="get_voter_opaque_round" class="idref" href="#get_voter_opaque_round"><span class="id" title="definition">get_voter_opaque_round</span></a> (<a id="state:266" class="idref" href="#state:266"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>) (<a id="v:267" class="idref" href="#v:267"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="r_n:268" class="idref" href="#r_n:268"><span class="id" title="binder">r_n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a> <br/>
&nbsp;&nbsp;:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <a class="idref" href="Grandpa.Protocol.html#v:267"><span class="id" title="variable">v</span></a> (<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a> <a class="idref" href="Grandpa.Protocol.html#state:266"><span class="id" title="variable">state</span></a>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;|<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">vs</span> ⇒ <a class="idref" href="Grandpa.Vectors.html#get"><span class="id" title="definition">Vectors.get</span></a> <span class="id" title="var">vs</span>.(<a class="idref" href="Grandpa.VoterState.html#rounds"><span class="id" title="projection">VoterState.rounds</span></a>) <a class="idref" href="Grandpa.Protocol.html#r_n:268"><span class="id" title="variable">r_n</span></a> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="voter_state_continuos_existence" class="idref" href="#voter_state_continuos_existence"><span class="id" title="lemma">voter_state_continuos_existence</span></a> `{<a id="H:269" class="idref" href="#H:269"><span class="id" title="binder">Io</span></a>}<br/>
&nbsp;&nbsp;(<a id="v:270" class="idref" href="#v:270"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>)<br/>
&nbsp;&nbsp;(<a id="t:271" class="idref" href="#t:271"><span class="id" title="binder">t</span></a>: <a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="r_n:272" class="idref" href="#r_n:272"><span class="id" title="binder">r_n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="is_some_at_t:274" class="idref" href="#is_some_at_t:274"><span class="id" title="binder">is_some_at_t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="vs1:273" class="idref" href="#vs1:273"><span class="id" title="binder">vs1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#v:270"><span class="id" title="variable">v</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a> (<a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> <a class="idref" href="Grandpa.Protocol.html#t:271"><span class="id" title="variable">t</span></a>)) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#vs1:273"><span class="id" title="variable">vs1</span></a><br/>
&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;(<a id="t_increment:275" class="idref" href="#t_increment:275"><span class="id" title="binder">t_increment</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="vs2:276" class="idref" href="#vs2:276"><span class="id" title="binder">vs2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Grandpa.Dictionary.html#lookup"><span class="id" title="definition">Dictionary.lookup</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#eqb"><span class="id" title="definition">Nat.eqb</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#v:270"><span class="id" title="variable">v</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#voters_state"><span class="id" title="projection">voters_state</span></a> (<a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> (<a class="idref" href="Grandpa.Protocol.html#t_increment:275"><span class="id" title="variable">t_increment</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><a class="idref" href="Grandpa.Protocol.html#t:271"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">nat</span> )) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#vs2:276"><span class="id" title="variable">vs2</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="round_continuos_existence" class="idref" href="#round_continuos_existence"><span class="id" title="lemma">round_continuos_existence</span></a> `{<a id="H:277" class="idref" href="#H:277"><span class="id" title="binder">Io</span></a>}<br/>
&nbsp;&nbsp;(<a id="v:278" class="idref" href="#v:278"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>)<br/>
&nbsp;&nbsp;(<a id="t:279" class="idref" href="#t:279"><span class="id" title="binder">t</span></a>: <a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="r_n:280" class="idref" href="#r_n:280"><span class="id" title="binder">r_n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="r1:281" class="idref" href="#r1:281"><span class="id" title="binder">r1</span></a>:<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a>)<br/>
&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="is_some_at_t:282" class="idref" href="#is_some_at_t:282"><span class="id" title="binder">is_some_at_t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Grandpa.Protocol.html#get_voter_opaque_round"><span class="id" title="definition">get_voter_opaque_round</span></a> (<a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> <a class="idref" href="Grandpa.Protocol.html#t:279"><span class="id" title="variable">t</span></a>) <a class="idref" href="Grandpa.Protocol.html#v:278"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#r_n:280"><span class="id" title="variable">r_n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#r1:281"><span class="id" title="variable">r1</span></a><br/>
&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;(<a id="t_increment:283" class="idref" href="#t_increment:283"><span class="id" title="binder">t_increment</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="r2:284" class="idref" href="#r2:284"><span class="id" title="binder">r2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Grandpa.Protocol.html#get_voter_opaque_round"><span class="id" title="definition">get_voter_opaque_round</span></a> (<a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> (<a class="idref" href="Grandpa.Protocol.html#t_increment:283"><span class="id" title="variable">t_increment</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><a class="idref" href="Grandpa.Protocol.html#t:279"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">nat</span>) <a class="idref" href="Grandpa.Protocol.html#v:278"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#r_n:280"><span class="id" title="variable">r_n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#r2:284"><span class="id" title="variable">r2</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="round_prevoters_consistent_over_time" class="idref" href="#round_prevoters_consistent_over_time"><span class="id" title="lemma">round_prevoters_consistent_over_time</span></a> `{<a id="H:285" class="idref" href="#H:285"><span class="id" title="binder">Io</span></a>}<br/>
&nbsp;&nbsp;(<a id="v:286" class="idref" href="#v:286"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>)<br/>
&nbsp;&nbsp;(<a id="t:287" class="idref" href="#t:287"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="r_n:288" class="idref" href="#r_n:288"><span class="id" title="binder">r_n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="r1:289" class="idref" href="#r1:289"><span class="id" title="binder">r1</span></a>:<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a>)<br/>
&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="is_some_at_t:290" class="idref" href="#is_some_at_t:290"><span class="id" title="binder">is_some_at_t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<a class="idref" href="Grandpa.Protocol.html#get_voter_opaque_round"><span class="id" title="definition">get_voter_opaque_round</span></a> (<a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> <a class="idref" href="Grandpa.Protocol.html#t:287"><span class="id" title="variable">t</span></a>) <a class="idref" href="Grandpa.Protocol.html#v:286"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#r_n:288"><span class="id" title="variable">r_n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#r1:289"><span class="id" title="variable">r1</span></a><br/>
&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;(<a id="t_increment:291" class="idref" href="#t_increment:291"><span class="id" title="binder">t_increment</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="r2:292" class="idref" href="#r2:292"><span class="id" title="binder">r2</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#get_voter_opaque_round"><span class="id" title="definition">get_voter_opaque_round</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> (<a class="idref" href="Grandpa.Protocol.html#t_increment:291"><span class="id" title="variable">t_increment</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a><a class="idref" href="Grandpa.Protocol.html#t:287"><span class="id" title="variable">t</span></a>)%<span class="id" title="var">nat</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#v:286"><span class="id" title="variable">v</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#r_n:288"><span class="id" title="variable">r_n</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#r2:292"><span class="id" title="variable">r2</span></a> <br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.OpaqueRound.html#get_prevote_voters"><span class="id" title="definition">OpaqueRound.get_prevote_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#r2:292"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Grandpa.OpaqueRound.html#get_prevote_voters"><span class="id" title="definition">OpaqueRound.get_prevote_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#r1:289"><span class="id" title="variable">r1</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="commits_came_from_voter" class="idref" href="#commits_came_from_voter"><span class="id" title="lemma">commits_came_from_voter</span></a> {<a id="n:293" class="idref" href="#n:293"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} (<a id="b:294" class="idref" href="#b:294"><span class="id" title="binder">b</span></a>:<a class="idref" href="Grandpa.Blocks.html#Block"><span class="id" title="inductive">Block</span></a> <a class="idref" href="Grandpa.Protocol.html#n:293"><span class="id" title="variable">n</span></a>) <br/>
&nbsp;&nbsp;{<a id="t:295" class="idref" href="#t:295"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>}<br/>
&nbsp;&nbsp;`{<a id="H:296" class="idref" href="#H:296"><span class="id" title="binder">Io</span></a>}<br/>
&nbsp;&nbsp;(<a id="state:297" class="idref" href="#state:297"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;(<a id="state_is_from_protocol:298" class="idref" href="#state_is_from_protocol:298"><span class="id" title="binder">state_is_from_protocol</span></a>: <a class="idref" href="Grandpa.Protocol.html#state:297"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a>  <a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> <a class="idref" href="Grandpa.Protocol.html#t:295"><span class="id" title="variable">t</span></a>)<br/>
&nbsp;&nbsp;(<a id="b_in:300" class="idref" href="#b_in:300"><span class="id" title="binder">b_in</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">List.In</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Blocks.html#to_any"><span class="id" title="definition">to_any</span></a> <a class="idref" href="Grandpa.Protocol.html#b:294"><span class="id" title="variable">b</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> ( <span class="id" title="keyword">fun</span> <a id="x:299" class="idref" href="#x:299"><span class="id" title="binder">x</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Grandpa.Protocol.html#x:299"><span class="id" title="variable">x</span></a>)) (<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a> <a class="idref" href="Grandpa.Protocol.html#state:297"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;:<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="r_n:301" class="idref" href="#r_n:301"><span class="id" title="binder">r_n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="v:302" class="idref" href="#v:302"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) <a id="tv:303" class="idref" href="#tv:303"><span class="id" title="binder">tv</span></a> <a id="pv_v:304" class="idref" href="#pv_v:304"><span class="id" title="binder">pv_v</span></a> <a id="pc_v:305" class="idref" href="#pc_v:305"><span class="id" title="binder">pc_v</span></a> <a id="t0:306" class="idref" href="#t0:306"><span class="id" title="binder">t0</span></a> <a id="t':307" class="idref" href="#t':307"><span class="id" title="binder">t'</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="r:308" class="idref" href="#r:308"><span class="id" title="binder">r</span></a>:<a class="idref" href="Grandpa.Round.html#RoundState"><span class="id" title="inductive">RoundState</span></a> <a class="idref" href="Grandpa.Protocol.html#tv:303"><span class="id" title="variable">tv</span></a> <a class="idref" href="Grandpa.Protocol.html#pv_v:304"><span class="id" title="variable">pv_v</span></a> <a class="idref" href="Grandpa.Protocol.html#pc_v:305"><span class="id" title="variable">pc_v</span></a> <a class="idref" href="Grandpa.Protocol.html#t0:306"><span class="id" title="variable">t0</span></a> <a class="idref" href="Grandpa.Protocol.html#r_n:301"><span class="id" title="variable">r_n</span></a> <a class="idref" href="Grandpa.Protocol.html#t':307"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Grandpa.Protocol.html#get_voter_opaque_round"><span class="id" title="definition">get_voter_opaque_round</span></a> <a class="idref" href="Grandpa.Protocol.html#state:297"><span class="id" title="variable">state</span></a> <a class="idref" href="Grandpa.Protocol.html#v:302"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#r_n:301"><span class="id" title="variable">r_n</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundStateC"><span class="id" title="constructor">OpaqueRound.OpaqueRoundStateC</span></a> <a class="idref" href="Grandpa.Protocol.html#r:308"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Preliminars.html#g"><span class="id" title="definition">g</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Grandpa.Round.html#get_all_precommit_votes"><span class="id" title="definition">get_all_precommit_votes</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">total_voters</span>:= <a class="idref" href="Grandpa.Round.html#get_total_voters"><span class="id" title="definition">Round.get_total_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#r:308"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <a class="idref" href="Grandpa.Protocol.html#r:308"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Grandpa.Blocks.html#to_any"><span class="id" title="definition">to_any</span></a> <a class="idref" href="Grandpa.Protocol.html#b:294"><span class="id" title="variable">b</span></a>).<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Grandpa.Protocol.html#ProtocolConsistency"><span class="id" title="section">ProtocolConsistency</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="VoterVotedInRound" class="idref" href="#VoterVotedInRound"><span class="id" title="definition">VoterVotedInRound</span></a> (<a id="v:309" class="idref" href="#v:309"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="opaque:310" class="idref" href="#opaque:310"><span class="id" title="binder">opaque</span></a>:<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a>)<br/>
&nbsp;&nbsp;:<span class="id" title="keyword">Prop</span><br/>
&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Votes.html#voter_voted_in_votes"><span class="id" title="definition">Votes.voter_voted_in_votes</span></a> <a class="idref" href="Grandpa.Protocol.html#v:309"><span class="id" title="variable">v</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#get_all_prevote_votes"><span class="id" title="definition">OpaqueRound.get_all_prevote_votes</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque:310"><span class="id" title="variable">opaque</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">∨</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Votes.html#voter_voted_in_votes"><span class="id" title="definition">Votes.voter_voted_in_votes</span></a> <a class="idref" href="Grandpa.Protocol.html#v:309"><span class="id" title="variable">v</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#get_all_precommit_votes"><span class="id" title="definition">OpaqueRound.get_all_precommit_votes</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque:310"><span class="id" title="variable">opaque</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e25"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="theorem_4_1" class="idref" href="#theorem_4_1"><span class="id" title="lemma">theorem_4_1</span></a> `{<a id="H:311" class="idref" href="#H:311"><span class="id" title="binder">Io</span></a>} <br/>
&nbsp;&nbsp;{<a id="n1:312" class="idref" href="#n1:312"><span class="id" title="binder">n1</span></a> <a id="n2:313" class="idref" href="#n2:313"><span class="id" title="binder">n2</span></a> :<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>} <br/>
&nbsp;&nbsp;(<a id="b1:314" class="idref" href="#b1:314"><span class="id" title="binder">b1</span></a>:<a class="idref" href="Grandpa.Blocks.html#Block"><span class="id" title="inductive">Block</span></a> <a class="idref" href="Grandpa.Protocol.html#n1:312"><span class="id" title="variable">n1</span></a>) <br/>
&nbsp;&nbsp;(<a id="b2:315" class="idref" href="#b2:315"><span class="id" title="binder">b2</span></a>:<a class="idref" href="Grandpa.Blocks.html#Block"><span class="id" title="inductive">Block</span></a> <a class="idref" href="Grandpa.Protocol.html#n2:313"><span class="id" title="variable">n2</span></a>) <br/>
&nbsp;&nbsp;(<a id="round_finalized_1:316" class="idref" href="#round_finalized_1:316"><span class="id" title="binder">round_finalized_1</span></a> <a id="round_finalized_2:317" class="idref" href="#round_finalized_2:317"><span class="id" title="binder">round_finalized_2</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="t1:318" class="idref" href="#t1:318"><span class="id" title="binder">t1</span></a> <a id="t2:319" class="idref" href="#t2:319"><span class="id" title="binder">t2</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="un_related:320" class="idref" href="#un_related:320"><span class="id" title="binder">un_related</span></a>:<a class="idref" href="Grandpa.Blocks.html#Unrelated"><span class="id" title="definition">Unrelated</span></a> <a class="idref" href="Grandpa.Protocol.html#b1:314"><span class="id" title="variable">b1</span></a> <a class="idref" href="Grandpa.Protocol.html#b2:315"><span class="id" title="variable">b2</span></a>)<br/>
&nbsp;&nbsp;(<a id="state:321" class="idref" href="#state:321"><span class="id" title="binder">state</span></a>:<a class="idref" href="Grandpa.Protocol.html#State"><span class="id" title="record">State</span></a>)<br/>
&nbsp;&nbsp;(<a id="t:322" class="idref" href="#t:322"><span class="id" title="binder">t</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="state_is_from_protocol:323" class="idref" href="#state_is_from_protocol:323"><span class="id" title="binder">state_is_from_protocol</span></a>: <a class="idref" href="Grandpa.Protocol.html#state:321"><span class="id" title="variable">state</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a>  <a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> <a class="idref" href="Grandpa.Protocol.html#t:322"><span class="id" title="variable">t</span></a>)<br/>
&nbsp;&nbsp;(<a id="b1_in:324" class="idref" href="#b1_in:324"><span class="id" title="binder">b1_in</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">List.In</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Blocks.html#to_any"><span class="id" title="definition">to_any</span></a> <a class="idref" href="Grandpa.Protocol.html#b1:314"><span class="id" title="variable">b1</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Protocol.html#t1:318"><span class="id" title="variable">t1</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Grandpa.Protocol.html#round_finalized_1:316"><span class="id" title="variable">round_finalized_1</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a> <a class="idref" href="Grandpa.Protocol.html#state:321"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;(<a id="b2_in:325" class="idref" href="#b2_in:325"><span class="id" title="binder">b2_in</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">List.In</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="Grandpa.Blocks.html#to_any"><span class="id" title="definition">to_any</span></a> <a class="idref" href="Grandpa.Protocol.html#b2:315"><span class="id" title="variable">b2</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="Grandpa.Protocol.html#t2:319"><span class="id" title="variable">t2</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="Grandpa.Protocol.html#round_finalized_2:317"><span class="id" title="variable">round_finalized_2</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> (<a class="idref" href="Grandpa.Protocol.html#global_finalized_blocks"><span class="id" title="projection">global_finalized_blocks</span></a> <a class="idref" href="Grandpa.Protocol.html#state:321"><span class="id" title="variable">state</span></a>))<br/>
&nbsp;&nbsp;(<a id="symmetry_hipotesis:326" class="idref" href="#symmetry_hipotesis:326"><span class="id" title="binder">symmetry_hipotesis</span></a>:<a class="idref" href="Grandpa.Protocol.html#round_finalized_1:316"><span class="id" title="variable">round_finalized_1</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a3"><span class="id" title="notation">≤</span></a> <a class="idref" href="Grandpa.Protocol.html#round_finalized_2:317"><span class="id" title="variable">round_finalized_2</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="r:327" class="idref" href="#r:327"><span class="id" title="binder">r</span></a>:<a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a>) (<a id="s:328" class="idref" href="#s:328"><span class="id" title="binder">s</span></a>:<a class="idref" href="Grandpa.Sets.html#DictionarySet"><span class="id" title="inductive">Sets.DictionarySet</span></a> <a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Grandpa.Sets.html#to_list"><span class="id" title="definition">Sets.to_list</span></a> <a class="idref" href="Grandpa.Protocol.html#s:328"><span class="id" title="variable">s</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f9"><span class="id" title="notation">≥</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Votes.html#calculate_max_bizantiners"><span class="id" title="definition">Votes.calculate_max_bizantiners</span></a> (<a class="idref" href="Grandpa.OpaqueRound.html#get_prevote_voters"><span class="id" title="definition">OpaqueRound.get_prevote_voters</span></a> <a class="idref" href="Grandpa.Protocol.html#r:327"><span class="id" title="variable">r</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v:329" class="idref" href="#v:329"><span class="id" title="binder">v</span></a>, <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">List.In</span></a> <a class="idref" href="Grandpa.Protocol.html#v:329"><span class="id" title="variable">v</span></a> (<a class="idref" href="Grandpa.Sets.html#to_list"><span class="id" title="definition">Sets.to_list</span></a> <a class="idref" href="Grandpa.Protocol.html#s:328"><span class="id" title="variable">s</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Grandpa.Protocol.html#VoterVotedInRound"><span class="id" title="definition">VoterVotedInRound</span></a> <a class="idref" href="Grandpa.Protocol.html#v:329"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#r:327"><span class="id" title="variable">r</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="voter_is_hones_at_round" class="idref" href="#voter_is_hones_at_round"><span class="id" title="definition">voter_is_hones_at_round</span></a> (<a id="v:330" class="idref" href="#v:330"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>) (<a id="r:331" class="idref" href="#r:331"><span class="id" title="binder">r</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
<span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Corollary</span> <a id="corollary_4_3" class="idref" href="#corollary_4_3"><span class="id" title="lemma">corollary_4_3</span></a> <br/>
&nbsp;&nbsp;`{<a id="H:332" class="idref" href="#H:332"><span class="id" title="binder">Io</span></a>}<br/>
&nbsp;&nbsp;(<a id="round_finalized_number:333" class="idref" href="#round_finalized_number:333"><span class="id" title="binder">round_finalized_number</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="time_finalied:334" class="idref" href="#time_finalied:334"><span class="id" title="binder">time_finalied</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="b_finalized:335" class="idref" href="#b_finalized:335"><span class="id" title="binder">b_finalized</span></a>:<a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a>)<br/>
&nbsp;&nbsp;(<a id="v:336" class="idref" href="#v:336"><span class="id" title="binder">v</span></a>:<a class="idref" href="Grandpa.Votes.html#Voter"><span class="id" title="definition">Voter</span></a>)<br/>
&nbsp;&nbsp;(<a id="r_n:337" class="idref" href="#r_n:337"><span class="id" title="binder">r_n</span></a>:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;(<a id="is_honest:338" class="idref" href="#is_honest:338"><span class="id" title="binder">is_honest</span></a>: <a class="idref" href="Grandpa.Protocol.html#voter_is_hones_at_round"><span class="id" title="axiom">voter_is_hones_at_round</span></a> <a class="idref" href="Grandpa.Protocol.html#v:336"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#r_n:337"><span class="id" title="variable">r_n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)<br/>
&nbsp;&nbsp;(<a id="t_increment:339" class="idref" href="#t_increment:339"><span class="id" title="binder">t_increment</span></a>:<a class="idref" href="Grandpa.Round.html#Time"><span class="id" title="definition">Time</span></a>)<br/>
&nbsp;&nbsp;(<a id="r_n_geq:340" class="idref" href="#r_n_geq:340"><span class="id" title="binder">r_n_geq</span></a>: <a class="idref" href="Grandpa.Protocol.html#r_n:337"><span class="id" title="variable">r_n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f9"><span class="id" title="notation">≥</span></a> <a class="idref" href="Grandpa.Protocol.html#round_finalized_number:333"><span class="id" title="variable">round_finalized_number</span></a>)<br/>
&nbsp;&nbsp;(<a id="opaque_r_n:341" class="idref" href="#opaque_r_n:341"><span class="id" title="binder">opaque_r_n</span></a> : <a class="idref" href="Grandpa.OpaqueRound.html#OpaqueRoundState"><span class="id" title="inductive">OpaqueRound.OpaqueRoundState</span></a>)<br/>
&nbsp;&nbsp;(<a id="opaque_from_state:342" class="idref" href="#opaque_from_state:342"><span class="id" title="binder">opaque_from_state</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Protocol.html#get_voter_opaque_round"><span class="id" title="definition">get_voter_opaque_round</span></a> (<a class="idref" href="Grandpa.Protocol.html#get_state_up_to"><span class="id" title="definition">get_state_up_to</span></a> (<a class="idref" href="Grandpa.Protocol.html#t_increment:339"><span class="id" title="variable">t_increment</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Nat.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> <a class="idref" href="Grandpa.Protocol.html#time_finalied:334"><span class="id" title="variable">time_finalied</span></a>)%<span class="id" title="var">nat</span> ) <a class="idref" href="Grandpa.Protocol.html#v:336"><span class="id" title="variable">v</span></a> <a class="idref" href="Grandpa.Protocol.html#r_n:337"><span class="id" title="variable">r_n</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque_r_n:341"><span class="id" title="variable">opaque_r_n</span></a><br/>
&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;(<a id="r_n_completable:343" class="idref" href="#r_n_completable:343"><span class="id" title="binder">r_n_completable</span></a>:<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.OpaqueRound.html#is_completable"><span class="id" title="definition">OpaqueRound.is_completable</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque_r_n:341"><span class="id" title="variable">opaque_r_n</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;)<br/>
&nbsp;&nbsp;:<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="eb:344" class="idref" href="#eb:344"><span class="id" title="binder">eb</span></a>:<a class="idref" href="Grandpa.Blocks.html#AnyBlock"><span class="id" title="definition">AnyBlock</span></a><a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.OpaqueRound.html#get_estimate"><span class="id" title="definition">OpaqueRound.get_estimate</span></a> <a class="idref" href="Grandpa.Protocol.html#opaque_r_n:341"><span class="id" title="variable">opaque_r_n</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Grandpa.Protocol.html#eb:344"><span class="id" title="variable">eb</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Grandpa.Blocks.html#is_prefix"><span class="id" title="definition">Blocks.is_prefix</span></a> (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <a class="idref" href="Grandpa.Protocol.html#b_finalized:335"><span class="id" title="variable">b_finalized</span></a>) (<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Specif.html#projT2"><span class="id" title="definition">projT2</span></a> <a class="idref" href="Grandpa.Protocol.html#eb:344"><span class="id" title="variable">eb</span></a>) <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/doc/V8.19.2/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>

<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">type_scope</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>